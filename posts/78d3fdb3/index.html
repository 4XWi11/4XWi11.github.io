<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/avatar.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/title.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"4xwi11.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.8.0","exturl":false,"sidebar":{"position":"right","width":320,"display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":false,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":true,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="&amp;nbsp;">
<meta property="og:type" content="article">
<meta property="og:title" content="20210710 CTFSHOW CJBCrypto方向部分WP">
<meta property="og:url" content="https://4xwi11.github.io/posts/78d3fdb3/index.html">
<meta property="og:site_name" content="4XWi11的博客">
<meta property="og:description" content="&amp;nbsp;">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ctf-wiki.org/crypto/asymmetric/rsa/figure/coppersmith-howgrave-graham.png">
<meta property="og:image" content="https://ctf-wiki.org/crypto/asymmetric/rsa/figure/coppersmith-f2g.png">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711134025217.png">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711144022632.png">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/56JSZRFN%7BE%60PAZORN_E%7D_PM.gif">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711151337886.png">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711152717959.png">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711154007056.png">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/VRD%7D_TUZ28Z%7BHXI95%7DR4SR4.jpg">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210712094503819.png">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210712093228438.png">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711101933363.png">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20211116183626206.png">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711162447275.png">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711174323480.png">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711190015963.png">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711190109271.png">
<meta property="article:published_time" content="2021-10-08T01:47:38.000Z">
<meta property="article:modified_time" content="2021-11-21T07:08:56.616Z">
<meta property="article:author" content="4XWi11">
<meta property="article:tag" content="曼切斯特">
<meta property="article:tag" content="CopperSmith">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ctf-wiki.org/crypto/asymmetric/rsa/figure/coppersmith-howgrave-graham.png">


<link rel="canonical" href="https://4xwi11.github.io/posts/78d3fdb3/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://4xwi11.github.io/posts/78d3fdb3/","path":"posts/78d3fdb3/","title":"20210710 CTFSHOW CJBCrypto方向部分WP"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>20210710 CTFSHOW CJBCrypto方向部分WP | 4XWi11的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">4XWi11的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fas fa-pray fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#CJB"><span class="nav-number">1.</span> <span class="nav-text">CJB</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Cop-Run"><span class="nav-number">1.1.</span> <span class="nav-text">Cop! Run!!</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CopperSmith%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86-%C2%B6"><span class="nav-number">1.2.</span> <span class="nav-text">CopperSmith基本原理 </span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%B7%E9%82%A3%E8%BE%B9%E6%BC%82%E6%9D%A5%E7%9A%84%E6%BC%82%E6%B5%81%E7%93%B6"><span class="nav-number">1.3.</span> <span class="nav-text">海那边漂来的漂流瓶</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BE%A4%E4%B8%BB%E8%AF%B4%E8%A6%81%E5%87%BA%E7%AE%80%E5%8D%95%E7%9A%84%E9%A2%98%E7%9B%AE%E5%A4%A7%E5%AE%B6%E6%8A%8A%E8%BF%99%E9%A2%98%E6%83%B3%E7%AE%80%E5%8D%95%E4%B8%80%E7%82%B9"><span class="nav-number">1.4.</span> <span class="nav-text">群主说要出简单的题目大家把这题想简单一点</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#The-Dedication-of-Suspect-M"><span class="nav-number">1.5.</span> <span class="nav-text">The Dedication of Suspect M</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#36D%E6%9D%AF"><span class="nav-number">2.</span> <span class="nav-text">36D杯</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#justShow"><span class="nav-number">2.1.</span> <span class="nav-text">justShow</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A3%9E%E9%B8%BD%E4%BC%A0%E4%B9%A6"><span class="nav-number">2.2.</span> <span class="nav-text">飞鸽传书</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#BJDCTF"><span class="nav-number">3.</span> <span class="nav-text">BJDCTF</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BC%96%E7%A0%81%E4%B8%8E%E8%B0%83%E5%88%B6"><span class="nav-number">3.1.</span> <span class="nav-text">编码与调制</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Polybius"><span class="nav-number">3.2.</span> <span class="nav-text">Polybius</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AF%86%E7%A0%81%E5%AD%A6AK%E8%B5%9B"><span class="nav-number">4.</span> <span class="nav-text">密码学AK赛</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A0%E6%B3%95"><span class="nav-number">4.1.</span> <span class="nav-text">加法</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="4XWi11"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">4XWi11</p>
  <div class="site-description" itemprop="description">CTF弱鸡自进阶</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">74</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">54</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/4XWi11" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;4XWi11" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/m0_49109277?spm=1000.2115.3001.5343" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;m0_49109277?spm&#x3D;1000.2115.3001.5343" rel="noopener" target="_blank"><i class="fab fa-cuttlefish fa-fw"></i>CSDN</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.yuque.com/jinjinshigekeaigui" title="https:&#x2F;&#x2F;www.yuque.com&#x2F;jinjinshigekeaigui" rel="noopener" target="_blank">j1ang（姜少 Web大师傅单身是大帅逼）</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://scr1pt-kid.github.io/" title="https:&#x2F;&#x2F;scr1pt-kid.github.io&#x2F;" rel="noopener" target="_blank">Scr1pt（V&N Misc师傅在做病毒分析）</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.cnblogs.com/yunqian2017/" title="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;yunqian2017&#x2F;" rel="noopener" target="_blank">Openg（彭总 Misc之神在考研）</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://blog.csdn.net/qq_53283643?spm=1001.2014.3001.5509" title="https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_53283643?spm&#x3D;1001.2014.3001.5509" rel="noopener" target="_blank">mxx307（尚师傅 Crypto担当）</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.yuque.com/benjieming-huvhr" title="https:&#x2F;&#x2F;www.yuque.com&#x2F;benjieming-huvhr" rel="noopener" target="_blank">Anza（谢师傅 大号在考研）</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://anza2001.github.io/" title="https:&#x2F;&#x2F;anza2001.github.io&#x2F;" rel="noopener" target="_blank">Anza（谢师傅 小号在Pwn）</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://jasonttu.github.io/" title="https:&#x2F;&#x2F;jasonttu.github.io&#x2F;" rel="noopener" target="_blank">Jason Tu（hhg 内网肾透）</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.yuque.com/qingguajun" title="https:&#x2F;&#x2F;www.yuque.com&#x2F;qingguajun" rel="noopener" target="_blank">Airtail（黄老板 Go带师）</a>
        </li>
    </ul>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/4XWi11" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://4xwi11.github.io/posts/78d3fdb3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="4XWi11">
      <meta itemprop="description" content="CTF弱鸡自进阶">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="4XWi11的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          20210710 CTFSHOW CJBCrypto方向部分WP
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-10-08 09:47:38" itemprop="dateCreated datePublished" datetime="2021-10-08T09:47:38+08:00">2021-10-08</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-11-21 15:08:56" itemprop="dateModified" datetime="2021-11-21T15:08:56+08:00">2021-11-21</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%A0%91%E5%93%A5%E8%AE%A9%E6%88%91%E5%A4%A9%E5%A4%A9%E5%86%99%E4%B9%8BCrypto/" itemprop="url" rel="index"><span itemprop="name">树哥让我天天写之Crypto</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>20k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>18 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>&nbsp;</p>
<span id="more"></span>

<h1 id="CJB"><a href="#CJB" class="headerlink" title="CJB"></a>CJB</h1><h2 id="Cop-Run"><a href="#Cop-Run" class="headerlink" title="Cop! Run!!"></a>Cop! Run!!</h2><p>la佬出的题目，这几天la佬的题可不是白刷的</p>
<blockquote>
<p>题目描述 </p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">n = <span class="number">1</span> &lt;&lt; <span class="number">8</span></span><br><span class="line">p = getPrime(n)</span><br><span class="line"><span class="built_in">print</span>(p)</span><br><span class="line"></span><br><span class="line">P.&lt;t&gt; = PolynomialRing(Zmod(p))</span><br><span class="line">f = t * t + randrange(p)</span><br><span class="line"><span class="built_in">print</span>(f)</span><br><span class="line"></span><br><span class="line">x = [randrange(p)]</span><br><span class="line">x += [f(x[<span class="number">0</span>])]</span><br><span class="line"><span class="built_in">print</span>([x_ &gt;&gt; (n - ceil(<span class="number">5</span> * n / <span class="number">7</span>)) <span class="keyword">for</span> x_ <span class="keyword">in</span> x])</span><br><span class="line"></span><br><span class="line">flag = bytes_to_long(flag)</span><br><span class="line">y = f(x[-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    y = f(y)</span><br><span class="line">    flag ^^= <span class="built_in">int</span>(y)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">92946459607669937513774102250057295249718593723232674702212854287358873135783</span></span><br><span class="line"><span class="string">t^2 + 43844336985235863734419631630425915388298791521868754583032904718644333115590</span></span><br><span class="line"><span class="string">[3248642833056635029095920782095626337949113592116495266, 4883935221919623989344404485025479346028101682781790392]</span></span><br><span class="line"><span class="string">193207529097125793778662519051231322609402866155819915933598367395102313904490702547833</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>hint</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Brad Pitt &amp; Angelina Jolie love each other hard in some movie.</span><br></pre></td></tr></table></figure>

<blockquote>
<p>解题思路</p>
</blockquote>
<p>题目中出现Cop，猜测是CopperSmith；从hint中获悉，一部零五年的电影《Mr Smith &amp; Mrs Smith》，是CopperSmith没跑了</p>
<p>先看代码，代码很简短，显然只要求出 x 的前两项，所有的问题就迎刃而解，或者说，只要知道 x[1] ，就可以求出 y ，然后依据异或的性质，加密即解密</p>
<p>而我们已知的是 x 右移73位的数据，显然是要求低位。自然而然可以想到方程的思想，设置几个变量，然后根据等式解方程。因为前面接触过 CopperSmith 在 RSA 中的应用，sage 里的 smal_roots 就是基于 CopperSmith 实现的</p>
<p>下面简单介绍一下 CopperSmith ，摘自CTF Wiki的介绍</p>
<hr>
<h2 id="CopperSmith基本原理-¶"><a href="#CopperSmith基本原理-¶" class="headerlink" title="CopperSmith基本原理 ¶"></a>CopperSmith基本原理 <a target="_blank" rel="noopener" href="https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_coppersmith_attack/#_1">¶</a></h2><p>Coppersmith 相关攻击与 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Don_Coppersmith">Don Coppersmith</a> 紧密相关，他提出了一种针对于模多项式（单变量，二元变量，甚至多元变量）找所有小整数根的多项式时间的方法。</p>
<p>这里我们以单变量为主进行介绍，假设</p>
<ul>
<li>模数为 N ，N 具有一个因子$b≥N^β,0&lt;β≤1$</li>
<li>多项式 F 的次数为$δ$</li>
</ul>
<p>那么该方法可以在$O(cδ^5log^9(N))$的复杂度内找到该多项式所有的根$x_0$，这里我们要求 $|x_0|&lt;cN^\frac{β^2}{δ}$。</p>
<p>在这个问题中，我们的目标是找到在模 N 意义下多项式所有的根，这一问题被认为是复杂的。<strong>Coppersmith method</strong> 主要是通过 <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Lenstra%E2%80%93Lenstra%E2%80%93Lov%C3%A1sz_lattice_basis_reduction_algorithm">Lenstra–Lenstra–Lovász lattice basis reduction algorithm</a>（LLL）方法找到</p>
<ul>
<li>与该多项式具有相同根 $x_0$</li>
<li>更小系数</li>
<li>定义域为整数域</li>
</ul>
<p>的多项式 g，由于在整数域上找多项式的根是简单的（Berlekamp–Zassenhaus），从而我们就得到了原多项式在模意义下的整数根。</p>
<p>那么问题的关键就是如何将 f 转换到 g 呢？Howgrave-Graham 给出了一种思路</p>
<img data-src="https://ctf-wiki.org/crypto/asymmetric/rsa/figure/coppersmith-howgrave-graham.png" alt="image-20180717210921382"  />

<p>也就是说我们需要找到一个具有 “更小系数” 的多项式 g，也就是下面的转换方式</p>
<img data-src="https://ctf-wiki.org/crypto/asymmetric/rsa/figure/coppersmith-f2g.png" alt="image-20180717211351350">

<p>在 LLL 算法中，有两点是非常有用的</p>
<ul>
<li>只对原来的基向量进行整数线性变换，这可以使得我们在得到 g 时，仍然以原来的 $x_0$ 为根。</li>
<li>生成的新的基向量的模长是有界的，这可以使得我们利用 Howgrave-Graham 定理。</li>
</ul>
<p>在这样的基础之上，我们再构造出多项式族 g 就可以了。</p>
<p>关于更加细节的内容，请自行搜索。同时这部分内容也会不断更新。</p>
<p>需要注意的是，由于 Coppersmith 根的约束，在 RSA 中的应用时，往往只适用于 e 较小的情况。</p>
<hr>
<p>总结，CopperSmith 可以用来一元甚至多元的多项式</p>
<p>回到题目，初步尝试，在尚师傅的指导下，我写出来了第一个多项式，设 $x_{0}$ 的低73位为 k<br>$$<br>f(x_{0}&lt;&lt;73+k)&gt;&gt;73=x_{1}<br>$$<br>是关于 k 的一元多项式，然后我们尝试能不能解</p>
<p>la佬的博客上有解一元和多元的脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Sage</span></span><br><span class="line"><span class="comment">#单元</span></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">f = (a + x)^e - c</span><br><span class="line">root = f.small_roots(X=<span class="number">2</span>^<span class="number">256</span>, beta=<span class="number">1</span>)[<span class="number">0</span>]  <span class="comment"># find root &lt; 2^256 with factor = n</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#多元</span></span><br><span class="line">load(<span class="string">&#x27;coppersmith.sage&#x27;</span>)</span><br><span class="line">P.&lt;x, y&gt; = PolynomialRing(GF(p))</span><br><span class="line">f = <span class="number">2</span>^<span class="number">170</span> * a^<span class="number">2</span> + <span class="number">2</span>^<span class="number">86</span> * a * x + x^<span class="number">2</span> - <span class="number">2</span>^<span class="number">85</span> * b + c - y</span><br><span class="line">roots = coron(f, X=<span class="number">2</span>^<span class="number">85</span>, Y=<span class="number">2</span>^<span class="number">85</span>, k=<span class="number">1</span>, debug=<span class="literal">True</span>)[<span class="number">0</span>]</span><br><span class="line">x, y = roots</span><br></pre></td></tr></table></figure>

<p>改了一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">92946459607669937513774102250057295249718593723232674702212854287358873135783</span></span><br><span class="line">Fp = Zmod(p)</span><br><span class="line">pi = <span class="number">43844336985235863734419631630425915388298791521868754583032904718644333115590</span></span><br><span class="line">x_ = [<span class="number">3248642833056635029095920782095626337949113592116495266</span>, <span class="number">4883935221919623989344404485025479346028101682781790392</span>]</span><br><span class="line"></span><br><span class="line">P.&lt;t&gt; = PolynomialRing(Fp)</span><br><span class="line">f = t * t + pi</span><br><span class="line"></span><br><span class="line">PR.&lt;k&gt; = PolynomialRing(Fp)</span><br><span class="line">s = f(x_[<span class="number">0</span>]*<span class="number">2</span>^<span class="number">73</span> + k)//<span class="number">2</span>*<span class="number">73</span>-x_[<span class="number">1</span>]</span><br><span class="line">root = s.small_roots(X=<span class="number">2</span>^<span class="number">73</span>, beta=<span class="number">1</span>)[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>

<p>emmmmm 有几个问题，首先这样向右位移不知道中不中，然后总是报越界的错</p>
<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711134025217.png" alt="image-20210711134025217"></p>
<p>在尝试以及一些等效替代无果后，我想到再添加一个变量；一是因为这样表示更加清晰，省去了向右位移的不确定性，二是la佬的博客里，也有求解多元多项式的脚本</p>
<p><em>解决不了就加一层，这是我从计网学来的</em></p>
<p>设 x[0] x[1] 的低73位为 k0 和 k1，写出来的等式是<br>$$<br>f(x_{0}&lt;&lt;73+k_0)=x_{1}&lt;&lt;73+k_1<br>$$<br>完成脚本的篡改，这个 coppersmith.sage 来自<a target="_blank" rel="noopener" href="https://github.com/mimoo/RSA-and-LLL-attacks">https://github.com/mimoo/RSA-and-LLL-attacks</a>，也是从la佬博客里看到的；la佬yyds</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">load(<span class="string">&quot;coppersmith.sage&quot;</span>)</span><br><span class="line"></span><br><span class="line">p = <span class="number">92946459607669937513774102250057295249718593723232674702212854287358873135783</span></span><br><span class="line">Fp = Zmod(p)</span><br><span class="line">pi = <span class="number">43844336985235863734419631630425915388298791521868754583032904718644333115590</span></span><br><span class="line">x_ = [<span class="number">3248642833056635029095920782095626337949113592116495266</span>, <span class="number">4883935221919623989344404485025479346028101682781790392</span>]</span><br><span class="line">c = <span class="number">193207529097125793778662519051231322609402866155819915933598367395102313904490702547833</span></span><br><span class="line"></span><br><span class="line">PR.&lt;t&gt; = PolynomialRing(Fp)</span><br><span class="line">f = t * t + pi</span><br><span class="line"></span><br><span class="line">PR.&lt;k0, k1&gt; = PolynomialRing(Fp)</span><br><span class="line">s = f(x_[<span class="number">0</span>]*<span class="number">2</span>^<span class="number">73</span> + k0)-x_[<span class="number">1</span>]*<span class="number">2</span>^<span class="number">73</span>-k1</span><br><span class="line">roots = coron(f, X=<span class="number">2</span>^<span class="number">85</span>, Y=<span class="number">2</span>^<span class="number">85</span>, k=<span class="number">1</span>, debug=<span class="literal">True</span>)[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>

<p>emmmmm conron没有定义，看了下 github 里的源码， 确实没有找到这个函数；然后对这个构造多项式是否可解也不是很确定，就做不下去了</p>
<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711144022632.png" alt="image-20210711144022632"></p>
<p>这份 github 里的有一个这个函数，但是感觉是用在 RSA 类型的题目上的</p>
<p>早上起来，抱着试一试的心态，又重新研究起这道题目；就是无止境的搜索吧，信息搜集的能力还是要向尚师傅学习</p>
<p>然后找到了原题</p>
<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/56JSZRFN%7BE%60PAZORN_E%7D_PM.gif" alt="img"></p>
<p>是三个月前 zer0pts CTF 的题目，看来这就是多刷题的意义。当时顺腾摸瓜，找到了 Joseph 师傅的博客，这位师傅是神人啊，之前好多东西都从他这里找到，TQQQQQL</p>
<p>然后当时就是改了他的脚本做出来的，除了一些推导（开始觉得哦原来如此，但后面发现就是把我的给展开了），当然最主要的，他提供了一个 coppersmith 求小根函数的 github 链接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">small_roots</span>(<span class="params">f, bounds, m=<span class="number">1</span>, d=<span class="literal">None</span></span>):</span></span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">not</span> d:</span><br><span class="line">		d = f.degree()</span><br><span class="line"></span><br><span class="line">	R = f.base_ring()</span><br><span class="line">	N = R.cardinality()</span><br><span class="line"></span><br><span class="line">	f /= f.coefficients().pop(<span class="number">0</span>)</span><br><span class="line">	f = f.change_ring(ZZ)</span><br><span class="line"></span><br><span class="line">	G = <span class="type">Sequence</span>([], f.parent())</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m+<span class="number">1</span>):</span><br><span class="line">		base = N^(m-i) * f^i</span><br><span class="line">		<span class="keyword">for</span> shifts <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(d), repeat=f.nvariables()):</span><br><span class="line">			g = base * prod(<span class="built_in">map</span>(power, f.variables(), shifts))</span><br><span class="line">			G.append(g)</span><br><span class="line"></span><br><span class="line">	B, monomials = G.coefficient_matrix()</span><br><span class="line">	monomials = vector(monomials)</span><br><span class="line"></span><br><span class="line">	factors = [monomial(*bounds) <span class="keyword">for</span> monomial <span class="keyword">in</span> monomials]</span><br><span class="line">	<span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">		B.rescale_col(i, factor)</span><br><span class="line"></span><br><span class="line">	B = B.dense_matrix().LLL()</span><br><span class="line"></span><br><span class="line">	B = B.change_ring(QQ)</span><br><span class="line">	<span class="keyword">for</span> i, factor <span class="keyword">in</span> <span class="built_in">enumerate</span>(factors):</span><br><span class="line">		B.rescale_col(i, <span class="number">1</span>/factor)</span><br><span class="line"></span><br><span class="line">	H = <span class="type">Sequence</span>([], f.parent().change_ring(QQ))</span><br><span class="line">	<span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">filter</span>(<span class="literal">None</span>, B*monomials):</span><br><span class="line">		H.append(h)</span><br><span class="line">		I = H.ideal()</span><br><span class="line">		<span class="keyword">if</span> I.dimension() == -<span class="number">1</span>:</span><br><span class="line">			H.pop()</span><br><span class="line">		<span class="keyword">elif</span> I.dimension() == <span class="number">0</span>:</span><br><span class="line">			roots = []</span><br><span class="line">			<span class="keyword">for</span> root <span class="keyword">in</span> I.variety(ring=ZZ):</span><br><span class="line">				root = <span class="built_in">tuple</span>(R(root[var]) <span class="keyword">for</span> var <span class="keyword">in</span> f.variables())</span><br><span class="line">				roots.append(root)</span><br><span class="line">			<span class="keyword">return</span> roots</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> []</span><br></pre></td></tr></table></figure>

<p>稍微改一下脚本就出来了，很快啊</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">load(<span class="string">&#x27;coppersmith.sage&#x27;</span>)</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">p = <span class="number">92946459607669937513774102250057295249718593723232674702212854287358873135783</span></span><br><span class="line">Fp = Zmod(p)</span><br><span class="line">b = <span class="number">43844336985235863734419631630425915388298791521868754583032904718644333115590</span></span><br><span class="line">c = <span class="number">193207529097125793778662519051231322609402866155819915933598367395102313904490702547833</span></span><br><span class="line">w0 = <span class="number">3248642833056635029095920782095626337949113592116495266</span></span><br><span class="line">w1 = <span class="number">4883935221919623989344404485025479346028101682781790392</span></span><br><span class="line"></span><br><span class="line">b,w0,w1 = <span class="built_in">map</span>(Fp, [b,w0,w1])</span><br><span class="line">PR.&lt;k0, k1&gt; = PolynomialRing(Fp)</span><br><span class="line"></span><br><span class="line">f = <span class="number">2</span>^<span class="number">146</span> * w0^<span class="number">2</span> + <span class="number">2</span>^<span class="number">74</span> * w0 * k0 + k0^<span class="number">2</span> - <span class="number">2</span>^<span class="number">73</span> * w1 + b - k1</span><br><span class="line">roots = small_roots(f, (<span class="number">2</span>^<span class="number">73</span>, <span class="number">2</span>^<span class="number">73</span>), m=<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">k0, k1 = roots</span><br><span class="line"></span><br><span class="line">v0 = <span class="number">2</span>^<span class="number">73</span> * w0 + k0</span><br><span class="line">v1 = <span class="number">2</span>^<span class="number">73</span> * w1 + k1</span><br><span class="line"></span><br><span class="line">PR.&lt;v&gt; = PolynomialRing(Fp)</span><br><span class="line">f = v^<span class="number">2</span> + b</span><br><span class="line">y = f(v1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    y = f(y)</span><br><span class="line">    c ^^= <span class="built_in">int</span>(y)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(c))</span><br></pre></td></tr></table></figure>

<p>当我整理WP的时候，将这个函数用到我昨天的等式上，发现也出来了，再贴一下完整脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">load(<span class="string">&quot;coppersmith.sage&quot;</span>)</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"></span><br><span class="line">p = <span class="number">92946459607669937513774102250057295249718593723232674702212854287358873135783</span></span><br><span class="line">Fp = Zmod(p)</span><br><span class="line">pi = <span class="number">43844336985235863734419631630425915388298791521868754583032904718644333115590</span></span><br><span class="line">x_ = [<span class="number">3248642833056635029095920782095626337949113592116495266</span>, <span class="number">4883935221919623989344404485025479346028101682781790392</span>]</span><br><span class="line">c = <span class="number">193207529097125793778662519051231322609402866155819915933598367395102313904490702547833</span></span><br><span class="line"></span><br><span class="line">PR.&lt;t&gt; = PolynomialRing(Fp)</span><br><span class="line">f = t * t + pi</span><br><span class="line"></span><br><span class="line">PR.&lt;k0, k1&gt; = PolynomialRing(Fp)</span><br><span class="line">s = f(x_[<span class="number">0</span>]*<span class="number">2</span>^<span class="number">73</span> + k0)-x_[<span class="number">1</span>]*<span class="number">2</span>^<span class="number">73</span>-k1</span><br><span class="line">roots = small_roots(s, (<span class="number">2</span>^<span class="number">73</span>, <span class="number">2</span>^<span class="number">73</span>), m=<span class="number">3</span>)[<span class="number">0</span>]</span><br><span class="line">k0, k1 = roots</span><br><span class="line"></span><br><span class="line">v0 = <span class="number">2</span>^<span class="number">73</span> * x_[<span class="number">0</span>] + k0</span><br><span class="line">v1 = <span class="number">2</span>^<span class="number">73</span> * x_[<span class="number">1</span>] + k1</span><br><span class="line"></span><br><span class="line">y = f(v1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">    y = f(y)</span><br><span class="line">    c ^^= <span class="built_in">int</span>(y)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(c))</span><br></pre></td></tr></table></figure>

<p>所以jo师傅博客上面的推导，其实我们已经做了大半，就差一个函数实现了</p>
<p><em>学到还挺多的。通过这道题，我认识到，以后在Crypto方向上，必须即时跟进新的题型，以及多逛逛github，并且足够幸运能够看懂一些原理，尽量都自己实现一下。现在确实tcl，之前实现的一个playfair，今天想跑的时候结果又错误满天飞</em></p>
<h2 id="海那边漂来的漂流瓶"><a href="#海那边漂来的漂流瓶" class="headerlink" title="海那边漂来的漂流瓶"></a>海那边漂来的漂流瓶</h2><p>春哥师傅的题目，当时我们组有师傅第二个做出来</p>
<blockquote>
<p>题目描述</p>
</blockquote>
<p>在海的那边漂过来一个漂流瓶，停在了沙滩上。 你把它捡起来，却不知道漂流瓶里的纸上到底写了些啥。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ZJ6 -3 AI6 G8 EL NJ4 EJ/ XJ4 1O3 FU3 RU RUP EJ/ XJ4 S06 54 284 Q/6 J0 ， 5J3 VU04 T;6 2J4 431 EJ/ XU3 。 Y4 1O3 D9 G3 S06 VU/6 ， U VM4 RU/ EJI4 RU XJ/6 G4 、 VUP 1O3 G4 、 W96 1O3 G4 、 WL6 M06 G4 、 VUP 5J6 VU04 、 VUP 5J6 G4 、 AUL6 XU4 VU04 、 W96 5J/ G4 、 5; CJ84 VU04 、 S06 W.6 VU04 、 MP6 XUP6 VU04 、 RU8 U4 VU04 、 RU8 U4 G4 、 W96 S06 G4 、 EL VM/6 G4 、 QU/6 2J/ VU04 。 ZJ6 X94 EK6 2U6 SO4 BJ/6 G4 T QJ6 WL6 1J4 WJ3 QJ6 WL6 QU6 1J4 T QJ6 WL6 2L3 WJ3 QJ6 WL6 QU6 2U6 C04 M3 QUP UP G.3 Y4 AJ3 QUP RU, 。 FU6 5J/ U.6 M6 XJ4 2J04 RU04 GK4 G6 2U6 M/4 2U4 FM3 2K6 JP4 WU6 ， Y94 W96 5J/ G4 M3 5; CJ84 VU04 5 RU0 M06 1P3 U/ E9 G4 S06 1O3 Y.3 VU;4 2U6 ZJ6 -3 AI6 G8 EL NJ4 EJ/ XJ4 CP3 XU4 J94 2U4 G4 T/6 VU04 2J/ VU VU;4 2U6 Y.3 VU;4 ， Y4 S06 1J4 1O3 G;4 VU0 RU/ 5; CJ84 VU04 ZP M06 VU; ， DJ84 J VU 54 W96 5J/ G4 J4 Z/ FM 、 J B4 FM 5 C.4 ， Y94 VU;4 VU VU/6 54 5; CJ84 VU04 1O3 1J4 2U6 5; CJ84 G4 ， U06 J VU （ NJ6 T/ 284 2J4 VU ） VU VU/6 54 5; CJ84 VU04 CK6 AO3 5P4 ， 5J03 EK4 RU, RUP4 56 RUL3 2U6 284 J0 ， DJ84 M,4 284 2J4 VU RUP4 BJ4 W96 5J/ G4 C93 VU04 2U4 FM 。 1U,6 J;4 RU4 183 ZJ6 X94 EK6 M/4 VU WU 94 ZJ3 VU.4 2U6 EK6 G4 1L EJI3 FU3 X96 I6 。 VU; 2JO4 M6 5J/ G0 EL 2; TJ EJO CJ86 G4 U3 TJ04 XU06 W96 J0 VU 04 5J3 UL4 284 T/6 G4 JO6 AJ4 2U6 ， DL3 XU;6 2L4 QU/6 C/6 2U4 FM Z8 503 、 WJ3 2U4 FM3 2K6 2U6 T/6 1P3 M3 1U4 AU03 2J G4 ZJ4 RUP4 2J03 WJ6 WJ/ FUP6 TK XU.6 YL4 T/6 YJ3 N9 ， ZJ6 -3 AI6 G8 EL NJ4 EJ/ XJ4 2U6 VM03 VU04 RU, DK4 U4 1U4 D9 1J4 ZP BP6 D.3 T.6 AU4 2U6 2J CJO4 FM 1U/4 RU/ EJI4 VM3 2JI M06 1P3 2U 2J4 D9 Z8 2U6 VU; HJP 2U4 294 。</span><br></pre></td></tr></table></figure>

<p>hint1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">广州火车站上霸气外露的标语：统一祖国 振兴中华</span><br></pre></td></tr></table></figure>

<p>hint2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">靠北耶！E04！</span><br></pre></td></tr></table></figure>

<blockquote>
<p> 解题思路</p>
</blockquote>
<p>显然是类似一种单表替换的东西，然后随便挑了几个去搜，就在 github 上找到<a target="_blank" rel="noopener" href="https://github.com/chinese-opendesktop/cin-tables/blob/master/bopomofo.cin">https://github.com/chinese-opendesktop/cin-tables/blob/master/bopomofo.cin</a> 至于第一个 hint 我到现在都没有理解其意思，第二个 hint 是台湾方言和台湾网络用语，夸你很牛逼的意思</p>
<p>github 里是正体注音輸入法的对照词库吧，正好对应了 E04! 的由来，也很呼应题目</p>
<p>然后手撕吧，太菜了，不会用 python 处理数据</p>
<p>撕到一半</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">福尔摩沙高速公路北起基金公路南至大鹏湾，主线长<span class="number">431</span>公里，自北开始南行，依序经过基隆市、台北县、桃园县、新竹县、苗栗县、台中县、彰化县、南投县、云林县、嘉义县、台南县、高雄县与屏东县。fu lai ge的内容是吃葡萄不吐葡萄皮不吃葡萄不吐葡萄皮的汉语拼音首字母拼接。</span><br></pre></td></tr></table></figure>

<p>另一位师傅说后面还有一些信息，但有师傅说直接输入这句顺口溜的拼音首字母就过了</p>
<p>过了就过了吧</p>
<p>然后看官方 WP 春哥师傅说可以用在线的网站搞；切换下输入法就好，强啊</p>
<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711151337886.png" alt="image-20210711151337886"></p>
<p><em>另外这种题目，比赛的时候不要死扣，能做出来就好，为了完美主义全部整出来绝对是浪费时间。在比赛中这点很重要。你有功夫大可赛后再搞，比如我现在就懒得搞了doge</em></p>
<hr>
<h2 id="群主说要出简单的题目大家把这题想简单一点"><a href="#群主说要出简单的题目大家把这题想简单一点" class="headerlink" title="群主说要出简单的题目大家把这题想简单一点"></a>群主说要出简单的题目大家把这题想简单一点</h2><p>xsl</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">24873777989291448485268365702265085243886872900039809831478881276969311714448924581398692832639705916538111455861057354225427758736198452679468399039512440497290615485190994957684665065261280544484301856860844163436499302230085760545686486398949018187416289923500558688885485672960734334858119391323987554701544773420070317895909846297195832399677291338220818181502181317849952785959097285626009703863257450199781708945715701136683994546852422993684382468187651935055302074609980311161155531603473091857526099148935429447319415714778860215376802270686310782735079899235228731429165106477537031235405221734008734614847</span></span><br><span class="line">e = <span class="number">12436888994645724242634182851132542621943436450019904915739440638484655857224462290699346416319852958269055727930528677112713879368099226339734199519756220248645307742595497478842332532630640272242150928430422081718249651115042880272843243199474509093708144961750279344442742836480367167429059695661993777350613653317802356713323129593521588320771616955563426747034967432053960828426250168954828986666929922730060781213890566121107119389060806644531516491192343284701151238691996162679338542186167193568672632227858449997036747029810933106336313085633759799229646747282205612102678724267585967720538082620536177904609</span></span><br><span class="line">c = <span class="number">7539424334663709603622451394173266049480031393220309445902319310504736287365860451132752036622339554159799611768328686792828750952551268647863160547774237934958072391797341405165512721597085695555356929495861914056799039140107261439671707574841789330531198534325422015873621769489969596614802282764401661006564546159674397356683650318142728009273827997179696988926599672213482848150751054351595386402597000601684644207559735499031666361222038615475154046453649719203304187309556004660926226182353445661702352380654352874617084419834338343925880593023307238768452509962</span></span><br></pre></td></tr></table></figure>

<p>e 很大，尝试过 boneh_durfee，但是出不来；检查条件，这 e 也太大了吧</p>
<p>然后在诸多hint中看到</p>
<p>当你凝视密文的时候，密文也在凝视着你。</p>
<p>妙啊，尼采</p>
<p>当你凝视密文的时候，明文也在凝视着你。直接 c 转字节，当时手快拿下一血</p>
<h2 id="The-Dedication-of-Suspect-M"><a href="#The-Dedication-of-Suspect-M" class="headerlink" title="The Dedication of Suspect M"></a>The Dedication of Suspect M</h2><p>麻了，这场比赛最麻的一道题。8神师傅的题目，春哥师傅隔了7分钟就出了并且全场唯一解，直到比赛结束，我都丝毫没有头绪</p>
<blockquote>
<p>题目描述</p>
</blockquote>
<p>题目信息很多，我直接给图了</p>
<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711152717959.png" alt="image-20210711152717959"></p>
<blockquote>
<p>解题思路</p>
</blockquote>
<p>我整理出来的，有以下线索：</p>
<ul>
<li><p>是一个动态的环境，提供压缩包下载，里面有个名为 M 的二进制文件，文件内容每重开一次环境都不相同、大小从 2K 到 5K 不等；那么flag 基本上也是动态的了</p>
</li>
<li><p>flag 的内容是小写字母的十六进制，中间有短横分隔</p>
</li>
<li><p>嫌疑人X的献身改成了嫌疑人M的陷深</p>
</li>
</ul>
<p>？？？有内味了？？？燃起来了？？？</p>
<p>一开始的时候丝毫没有头绪</p>
<p>根据现有的线索：动态的每次 flag 都不相同、0-9 a-f，我所能想到的就是</p>
<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711154007056.png" alt="image-20210711154007056"></p>
<p>但我和组内的师傅试过，不管是给文件 md5，还是给压缩包 md5，都不太行；md4也不行；还有是这个分割线不知道怎么切割，我一并按照样例来处理的，也不知道对不对。TNL，要达不溜屁</p>
<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/VRD%7D_TUZ28Z%7BHXI95%7DR4SR4.jpg" alt="img"></p>
<p>第三天起床补的，发现春哥师傅发博客了，这就去添</p>
<p>春哥师傅的思路是将那些不可见的字符给转变成换行符<code>0D 0A</code>，也就是<code>\r \n</code>，<strong>windows用<code>\r\n</code>表示换行</strong></p>
<p>就是将这些不可见的小点通过在128个ascii字符表中位移带走</p>
<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210712094503819.png" alt="image-20210712094503819"></p>
<p>春哥师傅准确计算出了密钥，我第一次也可以，但怎么改那些小字母数字提交的flag都不对，之后我重新开了几次环境，就直接爆破了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;../M&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    s = f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">128</span>):</span><br><span class="line">    t = <span class="built_in">bytes</span>([(x - i) % <span class="number">128</span> <span class="keyword">for</span> x <span class="keyword">in</span> s])</span><br><span class="line">    <span class="built_in">print</span>(t.decode())</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;&#x27;&#x27;===================================&#x27;&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>找到像样的，是figlet艺术字，手敲一遍</p>
<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210712093228438.png" alt="image-20210712093228438"></p>
<p>比赛结束，顺手带走几道水题，卡住了的记录一下</p>
<h1 id="36D杯"><a href="#36D杯" class="headerlink" title="36D杯"></a>36D杯</h1><h2 id="justShow"><a href="#justShow" class="headerlink" title="justShow"></a>justShow</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hlcgoyfsjqknyifnpd:bcdefghijklmnopqrstuvwxyza</span><br></pre></td></tr></table></figure>

<p>冒号后面的提示凯撒位移，移回来得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gkbfnxeripjmxhemoc:abcdefghijklmnopqrstuvwxyz</span><br></pre></td></tr></table></figure>

<p>然后没想到是playfair，后面是key；拿去在线网站解密一下</p>
<p>这里有点狗，因为playfair的字母表只有25个，一般是用i代替j；但这里不是，还没有明说，所以缺省情况是出不来的。因为key就是a-z，所以字母表就是a-z，不用代替任何字母了，随便改一下参数</p>
<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711101933363.png" alt="image-20210711101933363"></p>
<p>得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flagctfshow&#123;ctfshowicome&#125;</span><br></pre></td></tr></table></figure>

<h2 id="飞鸽传书"><a href="#飞鸽传书" class="headerlink" title="飞鸽传书"></a>飞鸽传书</h2><p>提供附件下载，pub.key</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TVdJd09HRm1NamMyWkdKak56VTVNekkzTVdZMFpXVTJNVFl5T0Rrek1qUWxNRUZsTW1GbE0yRXlNelV3TnpRell6VXhObU5rWVRReE1qUTVPV0poTTJKbE9TVXdRV0prWlRVeVkySXpNV1JsTXpObE5EWXlORFZsTURWbVltUmlaRFptWWpJMEpUQkJaVEl6WlRBd1ltVXpPV1F6Tm1Zek5EWXlaVFUzTm1FMk4yRTNaamt4T1RrbE1FRXhPR00zT1RJNE5XSTFNVFJqTmpObVl6a3dNelZsTTJZNU1qQmhaVFEzTnlVd1FXUmhORFJrWkRFNU1tUmxabVF4WW1VM09XWTJNMk16TlRCa01qa3lNR05tSlRCQk5ESTFNV00wWXpZME9XTTNaREptT0RZek1qZGxabVJsTWpNNU9USm1ZVGNsTUVGaFlXVTNZakprTkRneU16Z3lZV0ZoWkRjMVptUmxOalJrWmpobVpqZzJaaVV3UVRJNU5tWTNabVpqTW1VME5UUTFaR00zTnpreU1EVXdZMlZpTkdFNE56RXhKVEJCTmpFd04yRmpNV0UxTldZeFpUQm1aV05pTjJSa1lqWXdabUl6WW1ZeE1Ea2xNRUZoWldNeU16TXpNekl4WkRjek1EQXdNVFl4TmpneVpETmpOR1ZpWXpBd09TVXdRVFV3TURWaU0ySm1NREF3TlRCaVpqUm1OMlUwTTJGak16TmhNRFExTkdJNEpUQkI=</span><br></pre></td></tr></table></figure>

<p>不是很正规的PEM格式的公钥文件，尝试手撕，两次Base64，一次URL，得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1b08af276dbc7593271f4ee616289324</span><br><span class="line">e2ae3a2350743c516cda412499ba3be9</span><br><span class="line">bde52cb31de33e46245e05fbdbd6fb24</span><br><span class="line">e23e00be39d36f3462e576a67a7f9199</span><br><span class="line">18c79285b514c63fc9035e3f920ae477</span><br><span class="line">da44dd192defd1be79f63c350d2920cf</span><br><span class="line">4251c4c649c7d2f86327efde23992fa7</span><br><span class="line">aae7b2d482382aaad75fde64df8ff86f</span><br><span class="line">296f7ffc2e4545dc7792050ceb4a8711</span><br><span class="line">6107ac1a55f1e0fecb7ddb60fb3bf109</span><br><span class="line">aec2333321d73000161682d3c4ebc009</span><br><span class="line">5005b3bf00050bf4f7e43ac33a0454b8</span><br></pre></td></tr></table></figure>

<p>看着有点像MTP，跑一下美团用过的脚本，出来这样一个玩意，没有任何实际意思可言，麻了</p>
<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20211116183626206.png" alt="image-20211116183626206"></p>
<p>然后看了wp是hash函数类型的，然后找逆hash的网站，有些网站要登录收费了；解成功的几个发现是md4，且结果有数字和字母，于是自己写个爆破一下</p>
<p>记得hashlib库里好像没有md4，就从github上随便找了一段源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_pad</span>(<span class="params">msg</span>):</span></span><br><span class="line">    n = <span class="built_in">len</span>(msg)</span><br><span class="line">    bit_len = n * <span class="number">8</span></span><br><span class="line">    index = n &amp; <span class="number">0x3f</span></span><br><span class="line">    pad_len = <span class="number">120</span> - index</span><br><span class="line">    <span class="keyword">if</span> index &lt; <span class="number">56</span>:</span><br><span class="line">        pad_len = <span class="number">56</span> - index</span><br><span class="line">    padding = <span class="string">b&#x27;\x80&#x27;</span> + <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">63</span></span><br><span class="line">    suffix = bit_len.to_bytes(<span class="number">8</span>, <span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">    padded_msg = msg + padding[:pad_len] + suffix</span><br><span class="line">    <span class="keyword">return</span> padded_msg</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_left_rotate</span>(<span class="params">n, b</span>):</span></span><br><span class="line">    <span class="keyword">return</span> ((n &lt;&lt; b) | ((n &amp; <span class="number">0xffffffff</span>) &gt;&gt; (<span class="number">32</span> - b))) &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_if</span>(<span class="params">x, y, z</span>):</span></span><br><span class="line">    <span class="keyword">return</span> x &amp; y | ~x &amp; z</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_maj</span>(<span class="params">x, y, z</span>):</span></span><br><span class="line">    <span class="keyword">return</span> x &amp; y | x &amp; z | y &amp; z</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_xor3</span>(<span class="params">x, y, z</span>):</span></span><br><span class="line">    <span class="keyword">return</span> x ^ y ^ z</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_f1</span>(<span class="params">a, b, c, d, k, s, X</span>):</span></span><br><span class="line">    <span class="keyword">return</span> _left_rotate(a + _<span class="keyword">if</span>(b, c, d) + X[k], s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_f2</span>(<span class="params">a, b, c, d, k, s, X</span>):</span></span><br><span class="line">    <span class="keyword">return</span> _left_rotate(a + _maj(b, c, d) + X[k] + <span class="number">0x5a827999</span>, s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_f3</span>(<span class="params">a, b, c, d, k, s, X</span>):</span></span><br><span class="line">    <span class="keyword">return</span> _left_rotate(a + _xor3(b, c, d) + X[k] + <span class="number">0x6ed9eba1</span>, s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MD4</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.A = <span class="number">0x67452301</span></span><br><span class="line">        self.B = <span class="number">0xefcdab89</span></span><br><span class="line">        self.C = <span class="number">0x98badcfe</span></span><br><span class="line">        self.D = <span class="number">0x10325476</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update</span>(<span class="params">self, message_string</span>):</span></span><br><span class="line">        msg_bytes = _pad(message_string)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(msg_bytes), <span class="number">64</span>):</span><br><span class="line">            self._compress(msg_bytes[i:i + <span class="number">64</span>])</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_compress</span>(<span class="params">self, block</span>):</span></span><br><span class="line">        a, b, c, d = self.A, self.B, self.C, self.D</span><br><span class="line"></span><br><span class="line">        x = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">64</span>, <span class="number">4</span>):</span><br><span class="line">            x.append(<span class="built_in">int</span>.from_bytes(block[i:i + <span class="number">4</span>], <span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>))</span><br><span class="line"></span><br><span class="line">        a = _f1(a, b, c, d, <span class="number">0</span>, <span class="number">3</span>, x)</span><br><span class="line">        d = _f1(d, a, b, c, <span class="number">1</span>, <span class="number">7</span>, x)</span><br><span class="line">        c = _f1(c, d, a, b, <span class="number">2</span>, <span class="number">11</span>, x)</span><br><span class="line">        b = _f1(b, c, d, a, <span class="number">3</span>, <span class="number">19</span>, x)</span><br><span class="line">        a = _f1(a, b, c, d, <span class="number">4</span>, <span class="number">3</span>, x)</span><br><span class="line">        d = _f1(d, a, b, c, <span class="number">5</span>, <span class="number">7</span>, x)</span><br><span class="line">        c = _f1(c, d, a, b, <span class="number">6</span>, <span class="number">11</span>, x)</span><br><span class="line">        b = _f1(b, c, d, a, <span class="number">7</span>, <span class="number">19</span>, x)</span><br><span class="line">        a = _f1(a, b, c, d, <span class="number">8</span>, <span class="number">3</span>, x)</span><br><span class="line">        d = _f1(d, a, b, c, <span class="number">9</span>, <span class="number">7</span>, x)</span><br><span class="line">        c = _f1(c, d, a, b, <span class="number">10</span>, <span class="number">11</span>, x)</span><br><span class="line">        b = _f1(b, c, d, a, <span class="number">11</span>, <span class="number">19</span>, x)</span><br><span class="line">        a = _f1(a, b, c, d, <span class="number">12</span>, <span class="number">3</span>, x)</span><br><span class="line">        d = _f1(d, a, b, c, <span class="number">13</span>, <span class="number">7</span>, x)</span><br><span class="line">        c = _f1(c, d, a, b, <span class="number">14</span>, <span class="number">11</span>, x)</span><br><span class="line">        b = _f1(b, c, d, a, <span class="number">15</span>, <span class="number">19</span>, x)</span><br><span class="line"></span><br><span class="line">        a = _f2(a, b, c, d, <span class="number">0</span>, <span class="number">3</span>, x)</span><br><span class="line">        d = _f2(d, a, b, c, <span class="number">4</span>, <span class="number">5</span>, x)</span><br><span class="line">        c = _f2(c, d, a, b, <span class="number">8</span>, <span class="number">9</span>, x)</span><br><span class="line">        b = _f2(b, c, d, a, <span class="number">12</span>, <span class="number">13</span>, x)</span><br><span class="line">        a = _f2(a, b, c, d, <span class="number">1</span>, <span class="number">3</span>, x)</span><br><span class="line">        d = _f2(d, a, b, c, <span class="number">5</span>, <span class="number">5</span>, x)</span><br><span class="line">        c = _f2(c, d, a, b, <span class="number">9</span>, <span class="number">9</span>, x)</span><br><span class="line">        b = _f2(b, c, d, a, <span class="number">13</span>, <span class="number">13</span>, x)</span><br><span class="line">        a = _f2(a, b, c, d, <span class="number">2</span>, <span class="number">3</span>, x)</span><br><span class="line">        d = _f2(d, a, b, c, <span class="number">6</span>, <span class="number">5</span>, x)</span><br><span class="line">        c = _f2(c, d, a, b, <span class="number">10</span>, <span class="number">9</span>, x)</span><br><span class="line">        b = _f2(b, c, d, a, <span class="number">14</span>, <span class="number">13</span>, x)</span><br><span class="line">        a = _f2(a, b, c, d, <span class="number">3</span>, <span class="number">3</span>, x)</span><br><span class="line">        d = _f2(d, a, b, c, <span class="number">7</span>, <span class="number">5</span>, x)</span><br><span class="line">        c = _f2(c, d, a, b, <span class="number">11</span>, <span class="number">9</span>, x)</span><br><span class="line">        b = _f2(b, c, d, a, <span class="number">15</span>, <span class="number">13</span>, x)</span><br><span class="line"></span><br><span class="line">        a = _f3(a, b, c, d, <span class="number">0</span>, <span class="number">3</span>, x)</span><br><span class="line">        d = _f3(d, a, b, c, <span class="number">8</span>, <span class="number">9</span>, x)</span><br><span class="line">        c = _f3(c, d, a, b, <span class="number">4</span>, <span class="number">11</span>, x)</span><br><span class="line">        b = _f3(b, c, d, a, <span class="number">12</span>, <span class="number">15</span>, x)</span><br><span class="line">        a = _f3(a, b, c, d, <span class="number">2</span>, <span class="number">3</span>, x)</span><br><span class="line">        d = _f3(d, a, b, c, <span class="number">10</span>, <span class="number">9</span>, x)</span><br><span class="line">        c = _f3(c, d, a, b, <span class="number">6</span>, <span class="number">11</span>, x)</span><br><span class="line">        b = _f3(b, c, d, a, <span class="number">14</span>, <span class="number">15</span>, x)</span><br><span class="line">        a = _f3(a, b, c, d, <span class="number">1</span>, <span class="number">3</span>, x)</span><br><span class="line">        d = _f3(d, a, b, c, <span class="number">9</span>, <span class="number">9</span>, x)</span><br><span class="line">        c = _f3(c, d, a, b, <span class="number">5</span>, <span class="number">11</span>, x)</span><br><span class="line">        b = _f3(b, c, d, a, <span class="number">13</span>, <span class="number">15</span>, x)</span><br><span class="line">        a = _f3(a, b, c, d, <span class="number">3</span>, <span class="number">3</span>, x)</span><br><span class="line">        d = _f3(d, a, b, c, <span class="number">11</span>, <span class="number">9</span>, x)</span><br><span class="line">        c = _f3(c, d, a, b, <span class="number">7</span>, <span class="number">11</span>, x)</span><br><span class="line">        b = _f3(b, c, d, a, <span class="number">15</span>, <span class="number">15</span>, x)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># update state</span></span><br><span class="line">        self.A = (self.A + a) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        self.B = (self.B + b) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        self.C = (self.C + c) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        self.D = (self.D + d) &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">digest</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> binascii.hexlify(</span><br><span class="line">            self.A.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>) + \</span><br><span class="line">            self.B.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>) + \</span><br><span class="line">            self.C.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>) + \</span><br><span class="line">            self.D.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">        ).decode(<span class="string">&#x27;ascii&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>EXP</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage <span class="keyword">import</span> MD4</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> printable</span><br><span class="line"></span><br><span class="line">cipher = <span class="string">&#x27;&#x27;&#x27;1b08af276dbc7593271f4ee616289324</span></span><br><span class="line"><span class="string">e2ae3a2350743c516cda412499ba3be9</span></span><br><span class="line"><span class="string">bde52cb31de33e46245e05fbdbd6fb24</span></span><br><span class="line"><span class="string">e23e00be39d36f3462e576a67a7f9199</span></span><br><span class="line"><span class="string">18c79285b514c63fc9035e3f920ae477</span></span><br><span class="line"><span class="string">da44dd192defd1be79f63c350d2920cf</span></span><br><span class="line"><span class="string">4251c4c649c7d2f86327efde23992fa7</span></span><br><span class="line"><span class="string">aae7b2d482382aaad75fde64df8ff86f</span></span><br><span class="line"><span class="string">296f7ffc2e4545dc7792050ceb4a8711</span></span><br><span class="line"><span class="string">6107ac1a55f1e0fecb7ddb60fb3bf109</span></span><br><span class="line"><span class="string">aec2333321d73000161682d3c4ebc009</span></span><br><span class="line"><span class="string">5005b3bf00050bf4f7e43ac33a0454b8&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> printable:</span><br><span class="line">    m = MD4()</span><br><span class="line">    m.update(i.encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line">    t = m.digest()</span><br><span class="line">    <span class="keyword">if</span> t <span class="keyword">in</span> cipher:</span><br><span class="line">        cipher = cipher.replace(t, i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cipher.split():</span><br><span class="line">    <span class="built_in">print</span>(i, end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;36D_me&#125;</span><br></pre></td></tr></table></figure>

<p>以后md4不愁了，此外md4也是32位的</p>
<h1 id="BJDCTF"><a href="#BJDCTF" class="headerlink" title="BJDCTF"></a>BJDCTF</h1><h2 id="编码与调制"><a href="#编码与调制" class="headerlink" title="编码与调制"></a>编码与调制</h2><blockquote>
<p>题目描述</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">密文：2559659965656A9A65656996696965A6695669A9695A699569666A5A6A6569666A59695A69AA696569666AA6</span><br></pre></td></tr></table></figure>

<p>hint</p>
<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711162447275.png" alt="image-20210711162447275"></p>
<blockquote>
<p>解题思路</p>
</blockquote>
<p>计网的知识，曼切斯特和差分曼切斯特</p>
<ol>
<li>标准曼切斯特：低到高 0，高到底 1</li>
<li>IEEE曼切斯特：刚好相反，低到高 1，高到底 0</li>
<li>差分曼切斯特：前后相同为 0，不同为 1</li>
<li>其他类型：只有5，6，9，a这此种字符的</li>
<li>注意：存在字节逆序的问题：每8个字节一逆序</li>
</ol>
<p>老早就在la佬的博客看到，曼切斯特编码的脚本，这次终于用上了，收收好</p>
<p>显然密文中只出现了569a这几个字符，在其他解法这里</p>
<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711174323480.png" alt="image-20210711174323480"></p>
<p>这里是省略第一位的，不排除有其他变式，备份一下脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">long_to_bytes</span>(<span class="params">n</span>):</span></span><br><span class="line">    s = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    pack = struct.pack</span><br><span class="line">    <span class="keyword">while</span> n &gt; <span class="number">0</span>:</span><br><span class="line">        s = pack(<span class="string">&#x27;&gt;I&#x27;</span>, n &amp; <span class="number">0xffffffff</span>) + s</span><br><span class="line">        n = n &gt;&gt; <span class="number">32</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">        <span class="keyword">if</span> s[i] != <span class="string">b&#x27;\000&#x27;</span>[<span class="number">0</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s = <span class="string">b&#x27;\000&#x27;</span></span><br><span class="line">        i = <span class="number">0</span></span><br><span class="line">    s = s[i:]</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 字节逆序</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">byteinvert</span>(<span class="params">str_bin</span>):</span></span><br><span class="line">    ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str_bin) // <span class="number">8</span>):</span><br><span class="line">        ret += str_bin[i * <span class="number">8</span>:i * <span class="number">8</span> + <span class="number">8</span>][::-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 标准曼彻斯特</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">MCST_stand</span>(<span class="params">str_bin</span>):</span></span><br><span class="line">    ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(str_bin) // <span class="number">2</span>):</span><br><span class="line">        x = str_bin[i * <span class="number">2</span>:i * <span class="number">2</span> + <span class="number">2</span>]</span><br><span class="line">        <span class="keyword">if</span> x == <span class="string">&#x27;01&#x27;</span>:</span><br><span class="line">            ret += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> x == <span class="string">&#x27;10&#x27;</span>:</span><br><span class="line">            ret += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;stand manchester decode wrong!&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># IEEE规范的曼彻斯特</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">MCST_IEEE</span>(<span class="params">str_bin</span>):</span></span><br><span class="line">    ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(math.ceil(<span class="built_in">len</span>(str_bin) / <span class="number">8</span>)):</span><br><span class="line">        x = str_bin[i * <span class="number">2</span>:i * <span class="number">2</span> + <span class="number">2</span>]</span><br><span class="line">        <span class="keyword">if</span> x == <span class="string">&#x27;01&#x27;</span>:</span><br><span class="line">            ret += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">elif</span> x == <span class="string">&#x27;10&#x27;</span>:</span><br><span class="line">            ret += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;stand manchester decode wrong!&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 差分曼彻斯特</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">MCST_diff</span>(<span class="params">str_bin</span>):</span></span><br><span class="line">    ret = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(str_bin) // <span class="number">2</span> - <span class="number">1</span>):</span><br><span class="line">        x1 = str_bin[i * <span class="number">2</span>:i * <span class="number">2</span> + <span class="number">2</span>]</span><br><span class="line">        x2 = str_bin[i * <span class="number">2</span> + <span class="number">2</span>:i * <span class="number">2</span> + <span class="number">4</span>]</span><br><span class="line">        <span class="keyword">if</span> x1 == x2:</span><br><span class="line">            ret += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ret += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> ret</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    str_hex = <span class="string">&#x27;2559659965656A9A65656996696965A6695669A9695A699569666A5A6A6569666A59695A69AA696569666AA6&#x27;</span></span><br><span class="line">    <span class="comment"># str_bin=&#x27;0101010101010101&#x27;</span></span><br><span class="line">    str_bin = <span class="built_in">str</span>(<span class="built_in">bin</span>(<span class="built_in">int</span>(str_hex, <span class="number">16</span>)))[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">    m1 = MCST_IEEE(str_bin)</span><br><span class="line">    m2 = MCST_stand(str_bin)</span><br><span class="line">    m3 = MCST_diff(str_bin)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\nIEEE曼彻斯特:&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(m1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(m1, <span class="number">2</span>)))</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m1, <span class="number">2</span>)))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n 标准曼彻斯特:&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(m2)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(m2, <span class="number">2</span>)))</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m2, <span class="number">2</span>)))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n 差分曼彻斯特:&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(m3)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(m3, <span class="number">2</span>)))</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m3, <span class="number">2</span>)))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n=============字节逆序=============&#x27;</span>)</span><br><span class="line">    m1 = byteinvert(m1)</span><br><span class="line">    m2 = byteinvert(m2)</span><br><span class="line">    m3 = byteinvert(m3)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\nIEEE曼彻斯特:&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(m1)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(m1, <span class="number">2</span>)))</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m1, <span class="number">2</span>)))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n 标准曼彻斯特:&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(m2)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(m2, <span class="number">2</span>)))</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m2, <span class="number">2</span>)))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\n 差分曼彻斯特:&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(m3)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(m3, <span class="number">2</span>)))</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m3, <span class="number">2</span>)))</span><br></pre></td></tr></table></figure>

<h2 id="Polybius"><a href="#Polybius" class="headerlink" title="Polybius"></a>Polybius</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">密文：ouauuuoooeeaaiaeauieuooeeiea hint：VGhlIGxlbmd0aCBvZiB0aGlzIHBsYWludGV4dDogMTQ=</span><br></pre></td></tr></table></figure>

<p>hint解出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The length of this plaintext: 14</span><br></pre></td></tr></table></figure>

<p>密文全部是由5个元音字母组成，明文的长度是密文的一半，题目提示是是波利比奥斯棋盘密码，没有说密钥</p>
<p>所谓的波利比奥斯棋盘密码，和 playfair 同属于棋盘密码，它用字符表的坐标来代替坐；所以只有1-5，和playfair一样默认用 i 代替 j；这里没有特殊说明，密钥就取这个了</p>
<p>先转成数字，这里第一次犯了迷糊，因为不一定是以 aeiou 的顺序，还需要爆破，这就意味有120种可能；找到了现成的 python 库实现</p>
<p>看一遍就能懂，有一个坑，害我最后直接调试库里的代码才改正，就是这个参数必须给它大写的，不然后面会因为找不到而报错</p>
<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711190015963.png" alt="image-20210711190015963"></p>
<p>EXP</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> permutations</span><br><span class="line"><span class="keyword">from</span> pycipher <span class="keyword">import</span> PolybiusSquare</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_lowercase</span><br><span class="line"></span><br><span class="line">square = ascii_lowercase.replace(<span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">space = <span class="string">&#x27;AEIOU&#x27;</span></span><br><span class="line">cipher = <span class="string">&#x27;ouauuuoooeeaaiaeauieuooeeiea&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> permutations(space, <span class="number">5</span>):</span><br><span class="line">    l = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">list</span>(i))</span><br><span class="line">    p = PolybiusSquare(key=square, size=<span class="number">5</span>, chars=l)</span><br><span class="line">    m = p.decipher(cipher).lower()</span><br><span class="line">    <span class="keyword">if</span> m.startswith(<span class="string">&#x27;flag&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure>

<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20210711190109271.png" alt="image-20210711190109271"></p>
<p>好家伙找到了宝藏了</p>
<h1 id="密码学AK赛"><a href="#密码学AK赛" class="headerlink" title="密码学AK赛"></a>密码学AK赛</h1><h2 id="加法"><a href="#加法" class="headerlink" title="加法"></a>加法</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vtu[ypslg;sh&#125;lrunpstf[sddeptf\</span><br></pre></td></tr></table></figure>

<p>冥冥之中很熟悉，但却说不出来是啥加密；本来打算放弃，然后随便抽取一段出来出来搜，发现一篇CSDN的博客，讲的是为了使密码安全，将密码键位向右移动一位，所谓的键位就是在键盘上位置</p>
<p>直接手撕</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cryptoakflag&#123;keyboardpassword&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p>不做了，先到这里吧，瞄了一眼姜少的排名，竟然差这么多，害，差距已经那么大了吗</p>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>4XWi11
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://4xwi11.github.io/posts/78d3fdb3/" title="20210710 CTFSHOW CJBCrypto方向部分WP">https://4xwi11.github.io/posts/78d3fdb3/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/%E6%9B%BC%E5%88%87%E6%96%AF%E7%89%B9/" rel="tag"># 曼切斯特</a>
              <a href="/tags/CopperSmith/" rel="tag"># CopperSmith</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/798f5cbc/" rel="prev" title="20210706【胖哈勃的七月公开赛】">
                  <i class="fa fa-chevron-left"></i> 20210706【胖哈勃的七月公开赛】
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/e1a0b897/" rel="next" title="20210713 redpwnCrypto方向部分WP">
                  20210713 redpwnCrypto方向部分WP <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments utterances-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fas fa-user-secret"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">4XWi11</span>
  <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
  <script>
      var now = new Date(); 
      function createtime() { 
          var grt= new Date("10/6/2021 14:38:00");//此处修改你的建站时间或者网站上线时间 
          now.setTime(now.getTime()+250); 
          days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
          hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
          if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
          mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
          seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
          snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
          document.getElementById("timeDate").innerHTML = "博主已经爬了 "+dnum+" 天 "; 
          document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
      } 
  setInterval("createtime()",250);
  </script>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">1.1m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">15:57</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"4XWi11/comments","issue_term":"pathname","theme":"github-light","cdn":"https://utteranc.es/client.js"}</script>
<script src="/js/third-party/comments/utterances.js"></script>

</body>
</html>
