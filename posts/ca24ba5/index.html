<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/avatar.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/title.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"4xwi11.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.8.0","exturl":false,"sidebar":{"position":"right","width":320,"display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":"utterances","storage":true,"lazyload":false,"nav":null,"activeClass":"utterances"},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":true,"preload":false}}</script><script src="/js/config.js"></script>
<meta name="description" content="题不是我出的，是手出的，手是尚师傅出的🔪 参考（过的）文档 http:&#x2F;&#x2F;coinc1dens.me&#x2F;2019&#x2F;11&#x2F;01&#x2F;RSA-1.html#d-泄漏攻击 https:&#x2F;&#x2F;ctf-wiki.org&#x2F;crypto&#x2F;asymmetric&#x2F;rsa&#x2F;d_attacks&#x2F;rsa_d_attack&#x2F; https:&#x2F;&#x2F;crypto.stanford.edu&#x2F;~dabo&#x2F;papers&#x2F;RSA-survey.">
<meta property="og:type" content="article">
<meta property="og:title" content="20211221-PWHHUB-CryptoSecWP">
<meta property="og:url" content="https://4xwi11.github.io/posts/ca24ba5/index.html">
<meta property="og:site_name" content="4XWi11的博客">
<meta property="og:description" content="题不是我出的，是手出的，手是尚师傅出的🔪 参考（过的）文档 http:&#x2F;&#x2F;coinc1dens.me&#x2F;2019&#x2F;11&#x2F;01&#x2F;RSA-1.html#d-泄漏攻击 https:&#x2F;&#x2F;ctf-wiki.org&#x2F;crypto&#x2F;asymmetric&#x2F;rsa&#x2F;d_attacks&#x2F;rsa_d_attack&#x2F; https:&#x2F;&#x2F;crypto.stanford.edu&#x2F;~dabo&#x2F;papers&#x2F;RSA-survey.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20211222210953186.png">
<meta property="og:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20220103161009555.png">
<meta property="article:published_time" content="2022-01-03T10:07:03.000Z">
<meta property="article:modified_time" content="2022-01-03T10:20:07.724Z">
<meta property="article:author" content="4XWi11">
<meta property="article:tag" content="RSA">
<meta property="article:tag" content="泄漏d攻击">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20211222210953186.png">


<link rel="canonical" href="https://4xwi11.github.io/posts/ca24ba5/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://4xwi11.github.io/posts/ca24ba5/","path":"posts/ca24ba5/","title":"20211221-PWHHUB-CryptoSecWP"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>20211221-PWHHUB-CryptoSecWP | 4XWi11的博客</title>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">4XWi11的博客</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fas fa-pray fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#pwnhub12%E6%9C%88%E8%B5%9B"><span class="nav-number">1.</span> <span class="nav-text">pwnhub12月赛</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto-ecRNG"><span class="nav-number">1.1.</span> <span class="nav-text">Crypto-ecRNG</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto-easy-login"><span class="nav-number">1.2.</span> <span class="nav-text">Crypto-easy login</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto-sign-in-rsa"><span class="nav-number">1.3.</span> <span class="nav-text">Crypto-sign_in_rsa</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto-luukaka"><span class="nav-number">1.4.</span> <span class="nav-text">Crypto-luukaka</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="4XWi11"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">4XWi11</p>
  <div class="site-description" itemprop="description">CTF弱鸡自进阶</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">73</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">54</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/4XWi11" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;4XWi11" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://blog.csdn.net/m0_49109277?spm=1000.2115.3001.5343" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;m0_49109277?spm&#x3D;1000.2115.3001.5343" rel="noopener" target="_blank"><i class="fab fa-cuttlefish fa-fw"></i>CSDN</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.yuque.com/jinjinshigekeaigui" title="https:&#x2F;&#x2F;www.yuque.com&#x2F;jinjinshigekeaigui" rel="noopener" target="_blank">j1ang（姜少 Web大师傅单身是大帅逼）</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://scr1pt-kid.github.io/" title="https:&#x2F;&#x2F;scr1pt-kid.github.io&#x2F;" rel="noopener" target="_blank">Scr1pt（V&N Misc师傅在做病毒分析）</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.cnblogs.com/yunqian2017/" title="https:&#x2F;&#x2F;www.cnblogs.com&#x2F;yunqian2017&#x2F;" rel="noopener" target="_blank">Openg（彭总 Misc之神在考研）</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://blog.csdn.net/qq_53283643?spm=1001.2014.3001.5509" title="https:&#x2F;&#x2F;blog.csdn.net&#x2F;qq_53283643?spm&#x3D;1001.2014.3001.5509" rel="noopener" target="_blank">mxx307（尚师傅 Crypto担当）</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.yuque.com/benjieming-huvhr" title="https:&#x2F;&#x2F;www.yuque.com&#x2F;benjieming-huvhr" rel="noopener" target="_blank">Anza（谢师傅 大号在考研）</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://anza2001.github.io/" title="https:&#x2F;&#x2F;anza2001.github.io&#x2F;" rel="noopener" target="_blank">Anza（谢师傅 小号在Pwn）</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://jasonttu.github.io/" title="https:&#x2F;&#x2F;jasonttu.github.io&#x2F;" rel="noopener" target="_blank">Jason Tu（hhg 内网肾透）</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.yuque.com/qingguajun" title="https:&#x2F;&#x2F;www.yuque.com&#x2F;qingguajun" rel="noopener" target="_blank">Airtail（黄老板 Go带师）</a>
        </li>
    </ul>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/4XWi11" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://4xwi11.github.io/posts/ca24ba5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="4XWi11">
      <meta itemprop="description" content="CTF弱鸡自进阶">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="4XWi11的博客">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          20211221-PWHHUB-CryptoSecWP
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-01-03 18:07:03 / 修改时间：18:20:07" itemprop="dateCreated datePublished" datetime="2022-01-03T18:07:03+08:00">2022-01-03</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%A0%91%E5%93%A5%E8%AE%A9%E6%88%91%E5%A4%A9%E5%A4%A9%E5%86%99%E4%B9%8BCrypto/" itemprop="url" rel="index"><span itemprop="name">树哥让我天天写之Crypto</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>22k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>20 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>题不是我出的，是手出的，手是尚师傅出的🔪</p>
<p>参考（过的）文档</p>
<p><a target="_blank" rel="noopener" href="http://coinc1dens.me/2019/11/01/RSA-1.html#d-%E6%B3%84%E9%9C%B2%E6%94%BB%E5%87%BB">http://coinc1dens.me/2019/11/01/RSA-1.html#d-泄漏攻击</a></p>
<p><a target="_blank" rel="noopener" href="https://ctf-wiki.org/crypto/asymmetric/rsa/d_attacks/rsa_d_attack/">https://ctf-wiki.org/crypto/asymmetric/rsa/d_attacks/rsa_d_attack/</a></p>
<p><a target="_blank" rel="noopener" href="https://crypto.stanford.edu/~dabo/papers/RSA-survey.pdf">https://crypto.stanford.edu/~dabo/papers/RSA-survey.pdf</a></p>
<p><a target="_blank" rel="noopener" href="https://crypto.stackexchange.com/questions/70454/why-smarts-attack-doesnt-work-on-this-ecdlp">https://crypto.stackexchange.com/questions/70454/why-smarts-attack-doesnt-work-on-this-ecdlp</a></p>
<span id="more"></span>

<h1 id="pwnhub12月赛"><a href="#pwnhub12月赛" class="headerlink" title="pwnhub12月赛"></a>pwnhub12月赛</h1><h2 id="Crypto-ecRNG"><a href="#Crypto-ecRNG" class="headerlink" title="Crypto-ecRNG"></a>Crypto-ecRNG</h2><p>考点</p>
<ul>
<li>ecRNG</li>
</ul>
<p>用椭圆曲线来生成的PRNG伪随机数发生器，但是该曲线是不安全的，可以用smartAttack把私钥<code>r</code>给算出来</p>
<p>十几分钟</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha3_512</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">_sage_const_512 = Integer(<span class="number">512</span>);</span><br><span class="line">_sage_const_0xA15C4FB663A578D8B2496D3151A946119EE42695E18E13E90600192B1D0ABDBB6F787F90C8D102FF88E284DD4526F5F6B6C980BF88F1D0490714B67E8A2A2B77 = Integer(</span><br><span class="line">    <span class="number">0xA15C4FB663A578D8B2496D3151A946119EE42695E18E13E90600192B1D0ABDBB6F787F90C8D102FF88E284DD4526F5F6B6C980BF88F1D0490714B67E8A2A2B77</span>);</span><br><span class="line">_sage_const_0x5E009506FCC7EFF573BC960D88638FE25E76A9B6C7CAEEA072A27DCD1FA46ABB15B7B6210CF90CABA982893EE2779669BAC06E267013486B22FF3E24ABAE2D42 = Integer(</span><br><span class="line">    <span class="number">0x5E009506FCC7EFF573BC960D88638FE25E76A9B6C7CAEEA072A27DCD1FA46ABB15B7B6210CF90CABA982893EE2779669BAC06E267013486B22FF3E24ABAE2D42</span>);</span><br><span class="line">_sage_const_0x2CE7D1CA4493B0977F088F6D30D9241F8048FDEA112CC385B793BCE953998CAAE680864A7D3AA437EA3FFD1441CA3FB352B0B710BB3F053E980E503BE9A7FECE = Integer(</span><br><span class="line">    <span class="number">0x2CE7D1CA4493B0977F088F6D30D9241F8048FDEA112CC385B793BCE953998CAAE680864A7D3AA437EA3FFD1441CA3FB352B0B710BB3F053E980E503BE9A7FECE</span>);</span><br><span class="line">_sage_const_0x39F15E024D44228FD11C58A71C312FD64167C7D249D5677DA0DFB4B9C3ED0F90701837A5E77B5A2B74433D7FBE027CD0C73B5AA7B300F7384521AF0DC283DC6D = Integer(</span><br><span class="line">    <span class="number">0x39F15E024D44228FD11C58A71C312FD64167C7D249D5677DA0DFB4B9C3ED0F90701837A5E77B5A2B74433D7FBE027CD0C73B5AA7B300F7384521AF0DC283DC6D</span>);</span><br><span class="line">_sage_const_0x5F3636A89167A6FBB7B7D1AD97D11C70756835B5F1273E20C06D9E022D74648EC22A3F92C378196D137C3F2027A67381BE79E1C0D65CD9B61211A77A3842C8B2 = Integer(</span><br><span class="line">    <span class="number">0x5F3636A89167A6FBB7B7D1AD97D11C70756835B5F1273E20C06D9E022D74648EC22A3F92C378196D137C3F2027A67381BE79E1C0D65CD9B61211A77A3842C8B2</span>);</span><br><span class="line">_sage_const_2 = Integer(<span class="number">2</span>);</span><br><span class="line">_sage_const_210 = Integer(<span class="number">210</span>);</span><br><span class="line">_sage_const_1 = Integer(<span class="number">1</span>);</span><br><span class="line">_sage_const_384 = Integer(<span class="number">384</span>);</span><br><span class="line">_sage_const_0 = Integer(<span class="number">0</span>);</span><br><span class="line">_sage_const_9 = Integer(<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">size = _sage_const_512</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SmartAttack</span>(<span class="params">P, Q, p</span>):</span></span><br><span class="line">    E = P.curve()</span><br><span class="line">    Eqp = EllipticCurve(Qp(p, <span class="number">2</span>), [ZZ(t) + randint(<span class="number">0</span>, p) * p <span class="keyword">for</span> t <span class="keyword">in</span> E.a_invariants()])</span><br><span class="line"></span><br><span class="line">    P_Qps = Eqp.lift_x(ZZ(P.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> P_Qp <span class="keyword">in</span> P_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(P_Qp.xy()[<span class="number">1</span>]) == P.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    Q_Qps = Eqp.lift_x(ZZ(Q.xy()[<span class="number">0</span>]), <span class="built_in">all</span>=<span class="literal">True</span>)</span><br><span class="line">    <span class="keyword">for</span> Q_Qp <span class="keyword">in</span> Q_Qps:</span><br><span class="line">        <span class="keyword">if</span> GF(p)(Q_Qp.xy()[<span class="number">1</span>]) == Q.xy()[<span class="number">1</span>]:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    p_times_P = p * P_Qp</span><br><span class="line">    p_times_Q = p * Q_Qp</span><br><span class="line"></span><br><span class="line">    x_P, y_P = p_times_P.xy()</span><br><span class="line">    x_Q, y_Q = p_times_Q.xy()</span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P / y_P)</span><br><span class="line">    phi_Q = -(x_Q / y_Q)</span><br><span class="line">    k = phi_Q / phi_P</span><br><span class="line">    <span class="keyword">return</span> ZZ(k)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dec</span>(<span class="params">cipher, number</span>):</span></span><br><span class="line">    Inn = sha3_512(<span class="built_in">str</span>(number).encode()).hexdigest()</span><br><span class="line">    Inn = long_to_bytes(<span class="built_in">int</span>(Inn, <span class="number">16</span>))</span><br><span class="line">    key = Inn[:<span class="number">16</span>]</span><br><span class="line">    iv = Inn[<span class="number">32</span>:<span class="number">48</span>]</span><br><span class="line">    aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    m = aes.decrypt(<span class="built_in">bytes</span>.fromhex(cipher))</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = <span class="number">0xA15C4FB663A578D8B2496D3151A946119EE42695E18E13E90600192B1D0ABDBB6F787F90C8D102FF88E284DD4526F5F6B6C980BF88F1D0490714B67E8A2A2B77</span></span><br><span class="line">a = <span class="number">0x5E009506FCC7EFF573BC960D88638FE25E76A9B6C7CAEEA072A27DCD1FA46ABB15B7B6210CF90CABA982893EE2779669BAC06E267013486B22FF3E24ABAE2D42</span></span><br><span class="line">b = <span class="number">0x2CE7D1CA4493B0977F088F6D30D9241F8048FDEA112CC385B793BCE953998CAAE680864A7D3AA437EA3FFD1441CA3FB352B0B710BB3F053E980E503BE9A7FECE</span></span><br><span class="line"></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">P = E(</span><br><span class="line">    <span class="number">1717270988092568699558823338721769193577144381975368211582802328564507675390941376742024016097118883258330768453413278341089979563785352923619162792421720</span>,</span><br><span class="line">    <span class="number">4634112377728596645252853727020961671365750881389509274235513279641980340214649262199383894060530855372602832137073858683341979244741310958889147358144641</span>)</span><br><span class="line">Q = E(</span><br><span class="line">    <span class="number">3034712809375537908102988750113382444008758539448972750581525810900634243392172703684905257490982543775233630011707375189041302436945106395617312498769005</span>,</span><br><span class="line">    <span class="number">4986645098582616415690074082237817624424333339074969364527548107042876175480894132576399611027847402879885574130125050842710052291870268101817275410204850</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># d = SmartAttack(Q, P, p)</span></span><br><span class="line"><span class="comment"># print(d)</span></span><br><span class="line"><span class="comment"># d = 1197516373475505564855340799160714178328749125425344308252840761</span></span><br><span class="line"></span><br><span class="line">new = <span class="number">32745713477574202442635510163772855149196919427272374656320834804167355888344552445841916692444472764816564099439376659111769006339790502161761321431483387380993247845044928915756568692161000770265985467706760276545480280659321303215736675812511878180644086797137833292877929144343255703623965678401535173</span></span><br><span class="line">final_Ciphertext = <span class="string">&#x27;371a6fadfa7b2acdd3f948b308322c735134a6b706b4564e4816b3f3cab86f4ace5f497aafc1ad3a473c4b38fe394e83&#x27;</span></span><br><span class="line">new = <span class="built_in">bin</span>(new)[<span class="number">2</span>:].zfill(<span class="number">1024</span>)</span><br><span class="line">next2, next1 = <span class="built_in">int</span>(new[:<span class="number">512</span>], <span class="number">2</span>), <span class="built_in">int</span>(new[<span class="number">512</span>:], <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">next1 = next1 &lt;&lt; <span class="number">9</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">512</span>)):</span><br><span class="line">    rQ0 = next1 + i</span><br><span class="line">    <span class="comment"># y^2 \equiv x^3 + ax + b mod p</span></span><br><span class="line">    c = (rQ0 ** <span class="number">3</span> + a * rQ0 + b) % p</span><br><span class="line">    <span class="comment"># i_roots = [pow(c, (p + 1) // 4, p), (p - pow(c, (p + 1) // 4, p)) % p]</span></span><br><span class="line">    rQ1 = <span class="built_in">pow</span>(c, (p + <span class="number">1</span>) // <span class="number">4</span>, p)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># maybe not in the curve</span></span><br><span class="line">        rQ = E(rQ0, rQ1)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    r = SmartAttack(Q, rQ, p)</span><br><span class="line">    <span class="keyword">assert</span> r * Q == rQ</span><br><span class="line">    state = Integer((r * P)[<span class="number">0</span>])</span><br><span class="line">    sP = state * P</span><br><span class="line">    r = Integer(sP[_sage_const_0])</span><br><span class="line">    state = Integer((r * P)[_sage_const_0])</span><br><span class="line">    rQ = r * Q</span><br><span class="line">    nexti = Integer(rQ[_sage_const_0]) &gt;&gt; _sage_const_9</span><br><span class="line">    <span class="keyword">if</span> nexti == next2:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sP = state * P</span><br><span class="line">r = Integer(sP[_sage_const_0])</span><br><span class="line">state = Integer((r * P)[_sage_const_0])</span><br><span class="line">rQ = r * Q</span><br><span class="line">next1 = Integer(rQ[_sage_const_0]) &gt;&gt; _sage_const_9</span><br><span class="line"></span><br><span class="line">sP = state * P</span><br><span class="line">r = Integer(sP[_sage_const_0])</span><br><span class="line">state = Integer((r * P)[_sage_const_0])</span><br><span class="line">rQ = r * Q</span><br><span class="line">next2 = Integer(rQ[_sage_const_0]) &gt;&gt; _sage_const_9</span><br><span class="line">number = Integer(<span class="built_in">bin</span>(next2)[_sage_const_2:].zfill(size) + <span class="built_in">bin</span>(next1)[_sage_const_2:].zfill(size), _sage_const_2)</span><br><span class="line"><span class="built_in">print</span>(dec(final_Ciphertext, number))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;so__Cooool__about__the_backdoor!~&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Crypto-easy-login"><a href="#Crypto-easy-login" class="headerlink" title="Crypto-easy login"></a>Crypto-easy login</h2><p>考点</p>
<ul>
<li>AES.CBC模式整活（我直接Bytes Dancing好吧，和那几道题是同一类型的，但这次更典型一点，Fr.<a href="https://4xwi11.github.io/posts/e245e3dc/#Yusa%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6%E8%AF%BE%E5%A0%82%E2%80%94CBC%E7%AC%AC%E4%BA%8C%E8%AF%BE%EF%BC%88recuring%EF%BC%89">https://4xwi11.github.io/posts/e245e3dc/#Yusa的密码学课堂—CBC第二课（recuring）</a></li>
<li>MT19937伪随机数的恢复，<code>getrandbits</code>中的潜规则，用的是之前V&amp;N2020的脚本，Fr.<a href="https://4xwi11.github.io/posts/19a278ea/#Backtrace">https://4xwi11.github.io/posts/19a278ea/#Backtrace</a></li>
</ul>
<p>至于AES的脑洞，出题人还是很严谨的，代码中特意体现出来的东西都用到了（吧），但我对此几乎无感，两步都是尚师傅提示的。全部围绕下面这个东西展开的战斗</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;name&#125;##&#123;identity&#125;##&#123;sever_certificate&#125;##&#123;hash&#125;</span><br></pre></td></tr></table></figure>

<p>大致绕过方法如下：第二步登录之后需要先使得<code>identity</code>变成<code>admin</code>（默认是<code>guest</code>），这个在<code>token</code>前面加一段$iv\ \oplus\ \ guest\ \oplus admin$就可以成功通过，之后需要恢复死循环外面的一个512位的随机数<code>secret_key</code>从而获得flag；第一步每次注册加密的时候会生成一个256位的随机数<code>sever_certificate</code>，而登录解密的时候，如果<code>identity</code>位置的<code>&#123;&#125;</code>=<code>&#39;admin&#39;</code>会输出<code>name</code>位置的<code>&#123;&#125;</code>，借用第一步的方法我们可以把前面两个<code>&#123;name&#125;##&#123;identity&#125;##</code>给解成乱码（乱码对<code>.split(b&quot;##&quot;)</code>没有任何影响），这样就使得<code>&#123;sever_certificate&#125;</code>位置提前，之后再在密文中<code>&#123;sever_certificate&#125;</code>部分之后，加入类似<code>xor(xor(iv, b&#39;&#123;&#39; + b&#39;A&#39; * 15), b&#39;&#123;admin&#125;##&#123;xxx&#125;##&#39;) + token[:16]</code>的一段，就可以把<code>&#123;admin&#125;##&#123;xxx&#125;##</code>给添到<code>&#123;sever_certificate&#125;</code>之后，成功获得<code>sever_certificate</code>。凑足了78个256位（$32\times 624=78\times 256$）的<code>sever_certificate</code>就可以通过<code>recover_MT19937</code>恢复<code>secret_key</code>了</p>
<p>之前的题目是<code>getrandbits(32)</code>，经过尚师傅的手工测验后，<code>getrandbits(256)</code>就是32个前者比特串连起来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">token_decrypt</span>(<span class="params">Cipher: <span class="built_in">bytes</span>, iv: <span class="built_in">bytes</span>, key: <span class="built_in">bytes</span></span>):</span></span><br><span class="line">    aes = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        Plain = unpad(aes.decrypt(codecs.decode(Cipher, <span class="string">&#x27;hex&#x27;</span>)), <span class="number">16</span>).split(<span class="string">b&quot;##&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> (sha256(get_value(Plain[<span class="number">0</span>])).hexdigest().encode() != get_value(Plain[<span class="number">3</span>])):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[+] ERROR!&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> (get_value(Plain[<span class="number">1</span>]) == <span class="string">b&#x27;admin&#x27;</span>):</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[DEBUG] Wrong hash of&quot;</span>, get_value(Plain[<span class="number">0</span>]).decode(<span class="string">&#x27;latin1&#x27;</span>), <span class="string">&quot;!&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!] ERROR!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">return</span> Plain[<span class="number">0</span>], Plain[<span class="number">1</span>], Plain[<span class="number">2</span>]</span><br></pre></td></tr></table></figure>

<p>完整的exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> ascii_letters, digits</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> exploit.recoverMT19937 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">table = ascii_letters + digits</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solve</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># self.sh = remote(&#x27;127.0.0.1&#x27;, 10001)</span></span><br><span class="line">        self.sh = remote(<span class="string">&#x27;121.40.89.206&#x27;</span>, <span class="number">20002</span>)</span><br><span class="line">        self.ru = <span class="keyword">lambda</span> s: self.sh.recvuntil(s)</span><br><span class="line">        self.sl = <span class="keyword">lambda</span> s: self.sh.sendline(s)</span><br><span class="line">        self.rl = <span class="keyword">lambda</span>: self.sh.recvline()</span><br><span class="line">        self.sa = <span class="keyword">lambda</span> r, s: self.sh.sendlineafter(r, s)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">proof_of_work</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="comment"># [+] sha256(XXXX+if5aJODQwq478imy) == 8d90d5be903797ede85df21b403f33c3bbdc48a7e5c528dbcf0d3eb475145b58</span></span><br><span class="line">        <span class="comment"># [+] Plz tell me X<span class="doctag">XXX:</span></span></span><br><span class="line">        proof = self.ru(<span class="string">b&#x27;[-]&#x27;</span>)</span><br><span class="line">        tail = proof[<span class="number">16</span>:<span class="number">32</span>].decode()</span><br><span class="line">        _<span class="built_in">hash</span> = proof[<span class="number">37</span>:<span class="number">101</span>].decode()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> product(table, repeat=<span class="number">4</span>):</span><br><span class="line">            head = <span class="string">&#x27;&#x27;</span>.join(i)</span><br><span class="line">            t = sha256((head + tail).encode()).hexdigest()</span><br><span class="line">            <span class="keyword">if</span> t == _<span class="built_in">hash</span>:</span><br><span class="line">                self.sl(head.encode())</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">i_am_admin</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.ru(<span class="string">b&#x27;[-] &#x27;</span>)</span><br><span class="line">        self.sl(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">        self.ru(<span class="string">b&#x27;[-] &#x27;</span>)</span><br><span class="line">        self.sl(<span class="string">b&#x27;admin&#x27;</span>)</span><br><span class="line">        self.ru(<span class="string">b&#x27;[+] Here is your token and iv:\n[+] &#x27;</span>)</span><br><span class="line">        token = self.rl()[:-<span class="number">1</span>].decode()</span><br><span class="line">        self.ru(<span class="string">b&#x27;[+] &#x27;</span>)</span><br><span class="line">        iv = <span class="built_in">bytes</span>.fromhex(self.rl()[:-<span class="number">1</span>].decode())</span><br><span class="line">        self.ru(<span class="string">b&#x27;[-] &#x27;</span>)</span><br><span class="line">        self.sl(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">        guest = <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">10</span> + <span class="string">b&#x27;guest&#x27;</span> + <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">        admin = <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">10</span> + <span class="string">b&#x27;admin&#x27;</span> + <span class="string">b&#x27;\x00&#x27;</span></span><br><span class="line">        payload = xor(xor(iv, guest), admin).<span class="built_in">hex</span>()</span><br><span class="line">        payload += token</span><br><span class="line">        self.sl(payload)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">solve_s_c</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">recover_MT19937</span>(<span class="params">self, _key</span>):</span></span><br><span class="line">        keys = []</span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> _key:</span><br><span class="line">            i_key = <span class="built_in">bin</span>(_)[<span class="number">2</span>:].zfill(<span class="number">256</span>)</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(i_key) // <span class="number">32</span> - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">                keys.append(<span class="built_in">int</span>(i_key[j * <span class="number">32</span>: (j + <span class="number">1</span>) * <span class="number">32</span>], <span class="number">2</span>))</span><br><span class="line">        guess = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            parts = recover_state(keys[:<span class="number">624</span>])</span><br><span class="line">            state = backtrace([<span class="number">0</span>] * <span class="number">4</span> + parts)[:<span class="number">624</span>]</span><br><span class="line">            prng = Random()</span><br><span class="line">            prng.setstate((<span class="number">3</span>, <span class="built_in">tuple</span>(state + [<span class="number">0</span>]), <span class="literal">None</span>))</span><br><span class="line">            k1, k2, k3, k4 = prng.getrandbits(<span class="number">32</span>), prng.getrandbits(<span class="number">32</span>), prng.getrandbits(<span class="number">32</span>), prng.getrandbits(<span class="number">32</span>)</span><br><span class="line">            guess += <span class="built_in">bin</span>(k4)[<span class="number">2</span>:].zfill(<span class="number">32</span>) + <span class="built_in">bin</span>(k3)[<span class="number">2</span>:].zfill(<span class="number">32</span>) + <span class="built_in">bin</span>(k2)[<span class="number">2</span>:].zfill(<span class="number">32</span>) + <span class="built_in">bin</span>(k1)[<span class="number">2</span>:].zfill(<span class="number">32</span>)</span><br><span class="line">            keys = [k4, k3, k2, k1] + keys</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">int</span>(guess, <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">solve</span>(<span class="params">self</span>):</span></span><br><span class="line">        self.proof_of_work()</span><br><span class="line">        key = []</span><br><span class="line">        <span class="keyword">while</span> <span class="built_in">len</span>(key) &lt; <span class="number">78</span>:</span><br><span class="line">            self.sa(<span class="string">b&#x27;[-] &#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">            self.sa(<span class="string">b&#x27;[-] &#x27;</span>, <span class="string">b&#x27;A&#x27;</span> * <span class="number">15</span>)</span><br><span class="line">            self.ru(<span class="string">b&#x27;[+] Here is your token and iv:\n[+] &#x27;</span>)</span><br><span class="line">            token = <span class="built_in">bytes</span>.fromhex(self.rl()[:-<span class="number">1</span>].decode())</span><br><span class="line">            self.ru(<span class="string">b&#x27;[+] &#x27;</span>)</span><br><span class="line">            iv = <span class="built_in">bytes</span>.fromhex(self.rl()[:-<span class="number">1</span>].decode())</span><br><span class="line">            self.sa(<span class="string">b&#x27;[-] &#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">            it_is_my_trick = xor(xor(iv, <span class="string">b&#x27;&#123;&#x27;</span> + <span class="string">b&#x27;A&#x27;</span> * <span class="number">15</span>), <span class="string">b&#x27;&#123;admin&#125;##&#123;ji!&#125;##&#x27;</span>) + token[:<span class="number">16</span>]</span><br><span class="line">            payload = xor(iv, <span class="string">b&#x27;1&#x27;</span> * <span class="number">16</span>) + xor(<span class="string">b&#x27;1&#x27;</span> * <span class="number">12</span> + <span class="string">b&#x27;\x00&#x27;</span> * <span class="number">4</span>, token[:<span class="number">16</span>]) + \</span><br><span class="line">                      token[<span class="number">16</span>:<span class="number">288</span>] + it_is_my_trick + token[<span class="number">272</span>:<span class="number">288</span>] + token[<span class="number">288</span>:]</span><br><span class="line">            self.sl(payload.<span class="built_in">hex</span>())</span><br><span class="line">            self.ru(<span class="string">b&#x27;[DEBUG] Wrong hash of&#x27;</span>)</span><br><span class="line">            i_key = self.rl()[:-<span class="number">1</span>].decode()</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                i_key = <span class="built_in">int</span>(re.findall(<span class="string">r&quot;\d+&quot;</span>, i_key)[<span class="number">0</span>], <span class="number">2</span>)</span><br><span class="line">                key.append(i_key)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">        self.recover_MT19937(key)</span><br><span class="line">        self.i_am_admin()</span><br><span class="line">        self.sa(<span class="string">b&#x27;[-] &#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">        self.ru(<span class="string">b&#x27;you are admin:&#x27;</span>)</span><br><span class="line">        self.sh.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    solution = Solve()</span><br><span class="line">    solution.solve()</span><br></pre></td></tr></table></figure>

<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20211222210953186.png" alt="image-20211222210953186"></p>
<h2 id="Crypto-sign-in-rsa"><a href="#Crypto-sign-in-rsa" class="headerlink" title="Crypto-sign_in_rsa"></a>Crypto-sign_in_rsa</h2><p>考点</p>
<ul>
<li><p>RSA泄露$d$分解$N$</p>
</li>
<li><p>算法</p>
<ol>
<li>计算$k=ed-1$，并分解成$2^tr$（$r$是奇数）</li>
<li>随机选取$g$，$g\in\mathbb{Z}_N^*$</li>
<li>令$i$遍历$[0,\ t)$，如果$(g^{2^i\times r}-1, N)&gt;1$，则$p=(g^{2^i\times r}-1, N)$，$q=\frac{N}{p}$，返回$p,\ q$</li>
<li>否则回到第二步重新选取随机数</li>
</ol>
</li>
<li><p>原理</p>
<p>设$k=ed-1=\Delta_1\varphi(N)$，随机数$g\in\mathbb{Z}_N$，则$g^k\equiv g^{\Delta_1\varphi(N)}\equiv g^{\varphi(N)}\equiv1\ (mod\ N)$，即$g^k-1\equiv0(mod\ N)$，即<br>$$<br>g^k-1=N\Delta_2=pq\Delta_2<br>$$<br>我们想分解$N$，但是直接从$pq$下手会遇到大整数分解难题，而转换成$g^k-1$上则会有一些突破口；一般来说$(g^k-1,\ N)=N$</p>
<p>由于$k=ed-1$是偶数可以分解成$2^tr$的形式，其中$r$是奇数，所以$(1)$可以被分解成<br>$$<br>g^k-1=(g^{\frac{k}{2}}+1)(g^{\frac{k}{2}}-1)=pq\Delta_2\notag<br>$$<br>同理$(g^{\frac{k}{2}}-1)$能够被继续分解直到$(g^{\frac{k}{2^t}}+1)(g^{\frac{k}{2^t}}-1)$</p>
<p>结合CRT在QR &amp;&amp; square roots的应用，Fr.<a href="">窝的安全协议笔记</a></p>
<p>$(g^{\frac{k}{2^i}})^2\equiv g^{\frac{k}{2^{i-1}}}\equiv\dots\equiv g^{k}\equiv1\ (mod\ N)$，则</p>
<p>$\begin{align}g^{\frac{k}{2^i}}&amp;=CRT(&lt;1,\ 1&gt;)\leftrightarrow x_1\notag\\&amp;=CRT(&lt;1,\ -1&gt;)\leftrightarrow x_2\notag\\&amp;=CRT(&lt;-1,\ 1&gt;)\leftrightarrow x_3\notag\\&amp;=CRT(&lt;-1,\ -1&gt;)\leftrightarrow x_4\notag\end{align}$</p>
<p>只有在$x_2$或$x_3$的情况下，$g^{\frac{k}{2^i}}$才满足（$x_3$同理）<br>$$<br>\begin{cases}<br>g^{\frac{k}{2^i}}\equiv 1\ (mod\ p)\\<br>g^{\frac{k}{2^i}}\equiv -1\ (mod\ q)<br>\end{cases}\notag<br>$$<br>也就说$p$是$g^{\frac{k}{2^i}}-1$的因子，而$q$不是，这个时候求$(g^{2^i\times r}-1, N)$就是等于$p$（当然你换成$g^{\frac{k}{2^i}}+1$也可以</p>
<p>最后就是概率的问题，因为每求得一个$g^{\frac{k}{2^i}}$，其实它只对应一个$x_i$，而其是$x_2$或$x_3$的概率正好是$\frac{1}{2}$</p>
<p>而论文中说在${g\ |\ g\in \mathbb{Z}_N^*}$中，找到符合条件的$g$的概率是$\frac{1}{2}$（没想到为什么，统计出来的就罢了</p>
<p>贴一下原文，Fr.<a target="_blank" rel="noopener" href="https://crypto.stanford.edu/~dabo/papers/RSA-survey.pdf">https://crypto.stanford.edu/~dabo/papers/RSA-survey.pdf</a></p>
<p><img data-src="http://mypictruebed.oss-cn-hangzhou.aliyuncs.com/img/image-20220103161009555.png" alt="image-20220103161009555"></p>
</li>
</ul>
<p>变现成脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">divide_pq</span>(<span class="params">e, d, n</span>):</span></span><br><span class="line">    k = e * d - <span class="number">1</span></span><br><span class="line">    t, _k = <span class="number">0</span>, k</span><br><span class="line">    <span class="keyword">while</span> _k % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">        _k = _k // <span class="number">2</span></span><br><span class="line">    r = k // (<span class="number">2</span> ** t)</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        g = getrandbits(<span class="number">100</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(t):</span><br><span class="line">            p = gcd(<span class="built_in">pow</span>(g, <span class="number">2</span> ** i * r, n) - <span class="number">1</span>, n)</span><br><span class="line">            <span class="keyword">if</span> p &gt; <span class="number">1</span> <span class="keyword">and</span> p != n:</span><br><span class="line">                q = n // p</span><br><span class="line">                <span class="keyword">return</span> p, q</span><br></pre></td></tr></table></figure>

<p>最后有点像hash链的加密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> exploit.leakPrivateFracN <span class="keyword">import</span> d_leak_attack</span><br><span class="line"></span><br><span class="line">n, d = <span class="number">15029760235374231085969639414731714595094502023579580515142415364576906256445975070594748351717296265506796113025536826427911733196972964855469386448087417878697745924349624863909303165292167253527223263941652633363973854290523602860560486258509324353520104509387932968280508674316342236523385959602558170958614970693493378178016898028008319433088550790771390116863660130486812753414200478905354927474330477084174838392457570478397763649784441576899752400739324537777431123697771882670997321209911034933464741353255233083149611904906129535499692359926063803373853328404277847957250932127456840832115242266989310408337</span>, <span class="number">6510060024132448812692374598562478938781873276826121917136087171433612126001066486549172550775880633671688073309060742661536694848138785012316851139079566219427085669995770343650050947604387625705743119055063449704794632066543990637391557798194976737161835401498317792553501071727695913273255675957670000137254200491232988916899437811704442351184491702933366588255664254218916419493613957433723990485119540500734398920034539046985131363424063852960232153505171116298416691316690158260663800875225380729824947022224315510290836013992740531252154869626076244458736535349817731705617890688617614422279803126347527748253</span></span><br><span class="line">friend_keys = [(<span class="number">15029760235374231085969639414731714595094502023579580515142415364576906256445975070594748351717296265506796113025536826427911733196972964855469386448087417878697745924349624863909303165292167253527223263941652633363973854290523602860560486258509324353520104509387932968280508674316342236523385959602558170958614970693493378178016898028008319433088550790771390116863660130486812753414200478905354927474330477084174838392457570478397763649784441576899752400739324537777431123697771882670997321209911034933464741353255233083149611904906129535499692359926063803373853328404277847957250932127456840832115242266989310408337</span>, <span class="number">107273</span>), (<span class="number">15029760235374231085969639414731714595094502023579580515142415364576906256445975070594748351717296265506796113025536826427911733196972964855469386448087417878697745924349624863909303165292167253527223263941652633363973854290523602860560486258509324353520104509387932968280508674316342236523385959602558170958614970693493378178016898028008319433088550790771390116863660130486812753414200478905354927474330477084174838392457570478397763649784441576899752400739324537777431123697771882670997321209911034933464741353255233083149611904906129535499692359926063803373853328404277847957250932127456840832115242266989310408337</span>, <span class="number">80021</span>), (<span class="number">15029760235374231085969639414731714595094502023579580515142415364576906256445975070594748351717296265506796113025536826427911733196972964855469386448087417878697745924349624863909303165292167253527223263941652633363973854290523602860560486258509324353520104509387932968280508674316342236523385959602558170958614970693493378178016898028008319433088550790771390116863660130486812753414200478905354927474330477084174838392457570478397763649784441576899752400739324537777431123697771882670997321209911034933464741353255233083149611904906129535499692359926063803373853328404277847957250932127456840832115242266989310408337</span>, <span class="number">110281</span>), (<span class="number">15029760235374231085969639414731714595094502023579580515142415364576906256445975070594748351717296265506796113025536826427911733196972964855469386448087417878697745924349624863909303165292167253527223263941652633363973854290523602860560486258509324353520104509387932968280508674316342236523385959602558170958614970693493378178016898028008319433088550790771390116863660130486812753414200478905354927474330477084174838392457570478397763649784441576899752400739324537777431123697771882670997321209911034933464741353255233083149611904906129535499692359926063803373853328404277847957250932127456840832115242266989310408337</span>, <span class="number">125399</span>), (<span class="number">15029760235374231085969639414731714595094502023579580515142415364576906256445975070594748351717296265506796113025536826427911733196972964855469386448087417878697745924349624863909303165292167253527223263941652633363973854290523602860560486258509324353520104509387932968280508674316342236523385959602558170958614970693493378178016898028008319433088550790771390116863660130486812753414200478905354927474330477084174838392457570478397763649784441576899752400739324537777431123697771882670997321209911034933464741353255233083149611904906129535499692359926063803373853328404277847957250932127456840832115242266989310408337</span>, <span class="number">77641</span>)]</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">cipher = <span class="number">2621668640772056420471560098924704127784856790481388457844412769822118088860174800889321751481674422274270598394172919656578632970378187564960846030071830293875552723490431731972841568891484366856527528595054839456764493791012121047269761236912586905892771816051261702781783915560998982829509529868080760864895962974173385898354122495270178096361803788632815673814331531474332060419597040425174040815031894440262657639509623993308964349172916870911290368660953787873798343194799625182081014696063160131605363197089825537641567810410348240587342655465209891653946637101421879415183319402455214734741851508514452049810</span></span><br><span class="line"></span><br><span class="line">p, q = d_leak_attack(e, d, n)</span><br><span class="line"><span class="keyword">assert</span> p * q == n</span><br><span class="line">phi = n - p - q + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _, ei <span class="keyword">in</span> friend_keys[::-<span class="number">1</span>]:</span><br><span class="line">    di = inverse(ei, phi)</span><br><span class="line">    cipher = <span class="built_in">pow</span>(cipher, di, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(cipher))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;3ncrypt_y0ur_s3cr3t_w1th_y0ur_fr1end5_publ1c_k3y&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>有个疑问（或者说方法）</p>
<p>泄漏$d$攻击的步骤一定是像上面这样吗？</p>
<p>由$ed-1=k\varphi(n)$可知其实$e$和$k$是同一数量级的，而$e$一般都取65537，所以直接爆破就可以算出$\varphi(n)$岂不美哉</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_flag</span>(<span class="params">phi</span>):</span></span><br><span class="line">    <span class="keyword">for</span> _, ei <span class="keyword">in</span> friend_keys[::-<span class="number">1</span>]:</span><br><span class="line">        di = inverse(ei, phi)</span><br><span class="line">        cipher = <span class="built_in">pow</span>(cipher, di, n)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(cipher)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, e):</span><br><span class="line">    t = (e * d - <span class="number">1</span>) // k</span><br><span class="line">    <span class="keyword">if</span> get_flag(t).startswith(<span class="string">b&#x27;flag&#x27;</span>):</span><br><span class="line">        <span class="built_in">print</span>(get_flag(t))</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>但至于适用性还值得考量</p>
</li>
</ul>
<h2 id="Crypto-luukaka"><a href="#Crypto-luukaka" class="headerlink" title="Crypto-luukaka"></a>Crypto-luukaka</h2><p>考点</p>
<ul>
<li>CopperSimth求小根</li>
<li>Paillier同态加密的一般形式</li>
</ul>
<p>后者祥云杯遇到过，Fr.<a href="https://4xwi11.github.io/posts/60aa74b/#Crypto-Guess%EF%BC%88recuring%EF%BC%89">https://4xwi11.github.io/posts/60aa74b/#Crypto-Guess(recuring)</a></p>
<p>sage自带的pow是不是有点不听话？</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env sage</span></span><br><span class="line"><span class="comment"># coding: utf-8</span></span><br><span class="line">load(<span class="string">&#x27;exploit/coppersmithPHighBits.sage&#x27;</span>)</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, isPrime</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert, powmod</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> lcm</span><br><span class="line">n = <span class="number">14228073730190667444265758569232998545834341711432864414441434537856457554226009751489033431705491278975339077931622009743639467631071474363151300487078680100432725518596365988395929461561533250434031486424245896944629925135857622729999223390971276553928997508637911376545709237354833737994060265750787364825469605787468954601744025244062927831728713075259243916071854001703095748019042346899025896785151209455462423075169662092252456008356019267117214041106983803825784779879133738561202953888980952580302263891778856965344625783352907638953070740712616009213478262015624504889618788466893252102409611427088945902084609824939158090273141699828781599</span></span><br><span class="line">g = <span class="number">104756338318355948567384664103742452654286797799572772265848233334512623038814223410545840475708213491580933168492941525415723077772925906306730070567912467752229764629077391411738146979960676773739966985033493353135734679863468554065367379641641877776732166787383073606968314307988023048157536642389004806055502363198290047464507135522056378518722299068757453041609390692043233878813029502849305103895304519202811596850440711557164909395610847550061798126016783826231721060875732764619258276319683759960874598610474526487116193287935726659807081799695149604873036088612391197272153090414815760539467909235655538189612951075972603409435247362402276881345593351325034626085319241822974931255362490361433247117438845892276212349225050480473723922773661650238241659376681125743246319687880452040595990284620390242076959726572663250706701440702801135388505126093218792766996298711732747845811266552028107611595554772334895684283839272384369606543632542613172335294487221561323491737934377355876532240725521412046012357801914284413206938819420564131912564088387486730018108094449689965565218873981804619434009206386324135567769774069088701758230799594812616518042137489600048047478571983854027089251082355287707549749663822654965131297650047047655863594589307878048709000265824696160267631742318727023504</span></span><br><span class="line">c = <span class="number">110337660867664870668618596423399170421957516047679509225588623376743804308910177330738477934885576296064264107955132608068039716915229141255177656762910257465732348532323965821043865294553028096906547082618551373641823894294345439394320458729379584778338791447390149190354594056272453424922259417177887790371636260596466767307663828504719149380793176963386400546201890745560501746937761750771953027692686082999321908948997715677766808897936775024313229131624361695754073181908392043158729516103179521695533235615975097099246881718801578279171894214275303379728310998576306972004917364359907184627898803582606166064132907209594129554305783857639940803580780162589238990527574402229360311452329673309294811095686032780187382402401244208403608246186488287045631870185466768772070155917361936402870757098225660585142716834782054689740016959635568917565989361153748200711957665416078406041043067068946260735419003117885045170538814091969325447811589483805740159257095544507862038022099086715866062568327078082077714811272019367066364077835278254199402087714107154020099620284929159828186078676335901409411843708088949544768400190126243155520427016805835963333341089705359758522086506203013124445829394093909811080012839871046714948018821673486671778352056836826280481951815377888832291151086485700501159</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Function</span>(<span class="params">times, a, b</span>):</span></span><br><span class="line">    F = [<span class="number">2</span>,a]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(times):</span><br><span class="line">        F.append( a * F[-<span class="number">1</span>] - b * F[-<span class="number">2</span>])</span><br><span class="line">    <span class="keyword">return</span> F</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = <span class="number">0b11011101110111110</span></span><br><span class="line">b = <span class="number">0x11011101110</span></span><br><span class="line">s = (Function(<span class="number">77</span>,a,b)[-<span class="number">1</span>])</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">if</span> isPrime(s):</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s = s &gt;&gt; <span class="number">1</span></span><br><span class="line">Fn = Zmod(n)</span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Fn)</span><br><span class="line">f = (s &lt;&lt; <span class="number">64</span>) + x</span><br><span class="line">roots = f.small_roots(X=<span class="number">2</span>^<span class="number">64</span>, beta=<span class="number">0.4</span>)</span><br><span class="line">p = (s &lt;&lt; <span class="number">64</span>) + <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">assert</span> n % p == <span class="number">0</span></span><br><span class="line">q = n // p</span><br><span class="line">_<span class="keyword">lambda</span> = lcm(p - <span class="number">1</span>, q - <span class="number">1</span>)</span><br><span class="line">L = <span class="keyword">lambda</span> x: (x - <span class="number">1</span>) // n</span><br><span class="line">x = L(powmod(g, _<span class="keyword">lambda</span>, n*n))</span><br><span class="line">u = invert(x, n)</span><br><span class="line">m = (L(powmod(c, _<span class="keyword">lambda</span>, n*n))) * u % n</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;P4ll13r&amp;C0pP3r5m17h_m4y_b3_g00d_Fr13nds~&#125;</span><br></pre></td></tr></table></figure>

<p>接下来要学</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/eAJWraah9OOgJfZOhm4Sqg">https://mp.weixin.qq.com/s/eAJWraah9OOgJfZOhm4Sqg</a></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/205861#h2-7">https://www.anquanke.com/post/id/205861#h2-7</a></p>
<p><a target="_blank" rel="noopener" href="https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_complex/#prng-predict">https://ctf-wiki.org/crypto/asymmetric/rsa/rsa_complex/#prng-predict</a></p>
<p><a target="_blank" rel="noopener" href="https://wstein.org/edu/2010/414/projects/novotney.pdf">https://wstein.org/edu/2010/414/projects/novotney.pdf</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>4XWi11
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://4xwi11.github.io/posts/ca24ba5/" title="20211221-PWHHUB-CryptoSecWP">https://4xwi11.github.io/posts/ca24ba5/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/RSA/" rel="tag"># RSA</a>
              <a href="/tags/%E6%B3%84%E6%BC%8Fd%E6%94%BB%E5%87%BB/" rel="tag"># 泄漏d攻击</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/b83e9e49/" rel="prev" title="20211211 MT">
                  <i class="fa fa-chevron-left"></i> 20211211 MT
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/d42f9c86/" rel="next" title="20220108-CAZY">
                  20220108-CAZY <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments utterances-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fas fa-user-secret"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">4XWi11</span>
  <span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span>
  <script>
      var now = new Date(); 
      function createtime() { 
          var grt= new Date("10/6/2021 14:38:00");//此处修改你的建站时间或者网站上线时间 
          now.setTime(now.getTime()+250); 
          days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days); 
          hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours); 
          if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum); 
          mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;} 
          seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum); 
          snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;} 
          document.getElementById("timeDate").innerHTML = "博主已经爬了 "+dnum+" 天 "; 
          document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒"; 
      } 
  setInterval("createtime()",250);
  </script>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">1m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">15:51</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/lozad@1.16.0/dist/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>





  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"all","js":{"url":"https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js","integrity":"sha256-r+3itOMtGGjap0x+10hu6jW/gZCzxHsoKrOd7gyRSGY="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"4XWi11/comments","issue_term":"pathname","theme":"github-light","cdn":"https://utteranc.es/client.js"}</script>
<script src="/js/third-party/comments/utterances.js"></script>

</body>
</html>
